Notebook[{

Cell[CellGroupData[{
Cell["Generate results for Zika Vaccine", "Title",
 CellChangeTimes->{{3.6785318163621025`*^9, 3.678531826289426*^9}},
 ExpressionUUID -> "c59ccf06-6465-4524-8110-0fbfbd0ca33e"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.665342534050747*^9, 3.6653425348098574`*^9}, 
   3.7163241980964704`*^9, {3.7163244670996623`*^9, 3.7163244707872763`*^9}, 
   3.716473946520087*^9},
 ExpressionUUID -> "349ae692-e577-499d-ae5a-9434b97529ed"],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.6259225019784937`*^9, 3.62592250403695*^9}, {
  3.664885553142358*^9, 3.664885554407996*^9}, {3.665766751259662*^9, 
  3.6657667516670265`*^9}},
 ExpressionUUID -> "24ed90cd-875a-4625-92d3-b3e76788c346"],

Cell[CellGroupData[{

Cell["Headers", "Subsection",
 CellChangeTimes->{{3.6732868214094515`*^9, 3.6732868227639284`*^9}},
 ExpressionUUID -> "13fc85a0-8966-465d-8e8d-b38de185d382"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"$CommandLine", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<-wstp\>\""}], ",", 
    RowBox[{"ClusterRun", "=", "False"}], ",", 
    RowBox[{"ClusterRun", "=", "True"}]}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.6635915774477224`*^9, 3.663591579713333*^9}, {
  3.665767981221537*^9, 3.6657679920566235`*^9}},
 ExpressionUUID -> "ddf0b250-36b5-42db-94ee-d2adbd28380d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{"ClusterRun", ",", 
    RowBox[{"SetDirectory", "[", "\"\<./\>\"", "]"}], ",", 
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}]}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.6657667552011914`*^9, 3.665766766321019*^9}, {
   3.6657668162019587`*^9, 3.6657668163894596`*^9}, 3.676979764979746*^9, {
   3.684064288886879*^9, 3.6840642921038885`*^9}},
 ExpressionUUID -> "5dfa7cda-022a-40e7-be50-65bbce4bb351"],

Cell[BoxData[
 RowBox[{"Import", "[", "\"\<Zika vaccine model setup.m\>\"", "]"}]], "Code",
 CellChangeTimes->{{3.665330292895352*^9, 3.665330311253338*^9}},
 ExpressionUUID -> "93ee99b5-8256-4e67-882e-9d4586934bab"]
}, Closed]],

Cell[CellGroupData[{

Cell["Read in transmission rates", "Subsection",
 CellChangeTimes->{{3.7111211962753797`*^9, 3.711121201788829*^9}},
 ExpressionUUID -> "6620f76a-bd40-4d38-9206-402189f9a0ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.71096004785981*^9, 3.710960051706318*^9}},
 ExpressionUUID -> "30b61c03-34c9-457f-a8e9-a4f8b518e8c4"],

Cell[BoxData["\<\"D:\\\\Dropbox\\\\Code\\\\Git\\\\ZikaVaccineModel\"\>"], \
"Output",
 CellChangeTimes->{
  3.7109600519848194`*^9, 3.711121254399364*^9, 3.711122009012484*^9, 
   3.7111292393374877`*^9, 3.7111884423256207`*^9, 3.7112036024889755`*^9, 
   3.71121923474632*^9, 3.711284611708905*^9, 3.7113019902549195`*^9, 
   3.711303600823534*^9, 3.711306240054864*^9, 3.7113095792610083`*^9, 
   3.711312138026945*^9, 3.711312688493217*^9, 3.711316938995767*^9, 
   3.711323466872837*^9, 3.711385711032054*^9, 3.7113898411951303`*^9, 
   3.7114484737411947`*^9, 3.7114537665770435`*^9, 3.7114538087615013`*^9, 
   3.711455462659588*^9, 3.711461405640771*^9, 3.7114616861748667`*^9, 
   3.7114618873130465`*^9, 3.7114755559496346`*^9, 3.711716223006048*^9, 
   3.71173421674021*^9, {3.711734778023448*^9, 3.7117347983898706`*^9}, 
   3.711740449946512*^9, 3.7117990633470297`*^9, 3.7118028914663496`*^9, 
   3.7118045741787815`*^9, 3.7118107419522715`*^9, 3.7118126158052783`*^9, 
   3.711888894070585*^9, 3.7119051606887083`*^9, 3.7119209746914873`*^9, 
   3.7119813381125298`*^9, 3.7138838550640764`*^9, 3.7138842577899837`*^9, 
   3.7138845188101077`*^9, 3.714303175276029*^9, 3.714303358496426*^9, 
   3.7143203412704616`*^9, 3.7143220332610807`*^9, 3.714322106561055*^9, 
   3.7143221424205647`*^9, 3.7151093683797226`*^9, 3.71517787624046*^9, 
   3.715340941231011*^9, 3.716322296908173*^9, 3.716324209815663*^9, 
   3.7163244797486286`*^9, 3.716325013673271*^9, 3.71632516497968*^9, 
   3.716325661717451*^9, 3.7164708955584145`*^9, 3.7164711242743635`*^9, 
   3.71647195526538*^9, 3.7164736545772624`*^9, 3.716473972391839*^9, 
   3.716475131327852*^9, 3.7164758296477194`*^9},
 ExpressionUUID -> "0798dea9-71ec-4e46-8d82-25cfe6d9c6dd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"calibratedTransmissionRates", "=", 
   RowBox[{"Get", "[", "\"\<nonsexualTransmissionRates.dat\>\"", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.7109600550736227`*^9, 3.7109600907297935`*^9}, {
   3.7111212565395665`*^9, 3.711121268473462*^9}, 3.716471122182578*^9},
 ExpressionUUID -> "fe7e3218-656c-44f2-b3e6-146f38f79bbf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Setup scenario functionality", "Subsection",
 CellChangeTimes->{{3.7111213316026363`*^9, 3.7111213359821997`*^9}},
 ExpressionUUID -> "97ada040-05c0-457b-bb5b-1c2f80f9c61f"],

Cell[CellGroupData[{

Cell["Core model without vaccination", "Subsubsection",
 CellChangeTimes->{{3.7111293585374885`*^9, 3.711129363719784*^9}, 
   3.7111321336969285`*^9},
 ExpressionUUID -> "4a372468-896e-4d06-951e-4772f5dc9821"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "runBaseModel"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runBaseModel", "[", 
   RowBox[{"country_", ",", "betaHV_", ",", "betaMF_", ",", 
    RowBox[{"parameterOverride_:", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"basemodel", "=", 
       RowBox[{"Get", "[", 
        RowBox[{"\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"startyr", "=", "0"}], ",", 
      RowBox[{"endyr", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ComputeFinalTimeSeries", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"parameterOverride", ",", 
        RowBox[{"BaseParameters", "[", 
         RowBox[{"country", ",", "betaHV", ",", "betaMF"}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "NoVaccScen", "}"}], "]"}], ",", "\[IndentingNewLine]", 
      "country", ",", 
      RowBox[{"startcondsBase", "[", 
       RowBox[{"country", ",", "startyr", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], "&"}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], "&"}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{"0", "&"}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{"0", "&"}], ")"}]}], "]"}], ",", "startyr", ",", "endyr"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Code",
 CellChangeTimes->{{3.710604651269602*^9, 3.7106046771915855`*^9}, {
  3.710604757101575*^9, 3.710604761005576*^9}, {3.710604815870621*^9, 
  3.710604909422626*^9}, {3.710605281880785*^9, 3.7106052908843284`*^9}, {
  3.7106053284677196`*^9, 3.710605338446305*^9}, {3.7106054915873947`*^9, 
  3.7106055266427875`*^9}, {3.710697150988143*^9, 3.7106971512888637`*^9}, {
  3.711121448121833*^9, 3.711121500810484*^9}, {3.71112156330505*^9, 
  3.711121567611865*^9}},
 ExpressionUUID -> "8d4bc2e2-a882-4415-8b71-3075877bd6f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Core model with vaccination", "Subsubsection",
 CellChangeTimes->{{3.711129436584281*^9, 3.7111294394080257`*^9}, 
   3.711132129513037*^9},
 ExpressionUUID -> "4e3c43ea-e205-4b7f-be66-1203ce98a326"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"immunefunction", ",", "immunefunctionrange"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"immunefunction", "[", 
    RowBox[{
    "priorR_", ",", "ageover_", ",", "vaccagelow_", ",", "vaccagehigh_", ",", 
     "vaccrate_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "<", "ageover"}], "&&", 
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
          "vaccagelow", "\[LessEqual]", "#", "\[LessEqual]", "vaccagehigh"}], 
          ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "<", "ageover"}], "&&", 
        RowBox[{"(", 
         RowBox[{
         "vaccagelow", "\[LessEqual]", "#", "\[LessEqual]", "vaccagehigh"}], 
         ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "-", "vaccrate"}], ",", "0", ",", "vaccrate"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "\[GreaterEqual]", "ageover"}], "&&", 
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
          "vaccagelow", "\[LessEqual]", "#", "\[LessEqual]", "vaccagehigh"}], 
          ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "priorR"}], ")"}], ",", "priorR", ",", "0"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "\[GreaterEqual]", "ageover"}], "&&", 
        RowBox[{"(", 
         RowBox[{
         "vaccagelow", "\[LessEqual]", "#", "\[LessEqual]", "vaccagehigh"}], 
         ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "priorR"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "vaccrate"}], ")"}]}], ",", "priorR", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "priorR"}], ")"}], "*", "vaccrate"}]}], "}"}]}], 
      "]"}], "&"}], ")"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"immunefunctionrange", "[", 
   RowBox[{
   "priorR_", ",", "ageover_", ",", "vaccagerange_", ",", "vaccrate_"}], 
   "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "<", "ageover"}], "&&", 
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"vaccagerange", ",", "#"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"#", "<", "ageover"}], "&&", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"vaccagerange", ",", "#"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", "vaccrate"}], ",", "0", ",", "vaccrate"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"#", "\[GreaterEqual]", "ageover"}], "&&", 
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"vaccagerange", ",", "#"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "priorR"}], ")"}], ",", "priorR", ",", "0"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"#", "\[GreaterEqual]", "ageover"}], "&&", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"vaccagerange", ",", "#"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "priorR"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", "vaccrate"}], ")"}]}], ",", "priorR", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "priorR"}], ")"}], "*", "vaccrate"}]}], "}"}]}], 
     "]"}], "&"}], ")"}]}]}], "Code",
 CellChangeTimes->{{3.6846099579857707`*^9, 3.684609994540243*^9}, {
  3.6846100832380066`*^9, 3.6846100893161163`*^9}, {3.6847671834342003`*^9, 
  3.684767186974285*^9}, {3.684767276463111*^9, 3.684767278293569*^9}, {
  3.68692962868551*^9, 3.6869296293714733`*^9}, {3.6869339464031935`*^9, 
  3.6869339503775578`*^9}},
 ExpressionUUID -> "614bd60b-06bf-4b7c-9a45-337692100cf5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"FemaleImmuneFunction", ",", "MaleImmuneFunction"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FemaleImmuneFunction", "[", 
    RowBox[{
    "femaleagerange_", ",", "priorR_", ",", "ageover_", ",", "vaccagelow_", 
     ",", "vaccagehigh_", ",", "femalevacc_", ",", "vaccrate_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"femaleagerange", "\[Equal]", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"immunefunction", "[", 
      RowBox[{
      "priorR", ",", "ageover", ",", "vaccagelow", ",", "vaccagehigh", ",", 
       RowBox[{"If", "[", 
        RowBox[{"femalevacc", ",", "vaccrate", ",", "0"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"immunefunctionrange", "[", 
      RowBox[{
      "priorR", ",", "ageover", ",", "femaleagerange", ",", "vaccrate"}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MaleImmuneFunction", "[", 
   RowBox[{
   "maleagerange_", ",", "priorR_", ",", "ageover_", ",", "vaccagelow_", ",", 
    "vaccagehigh_", ",", "malevacc_", ",", "vaccrate_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"maleagerange", "\[Equal]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"immunefunction", "[", 
     RowBox[{
     "priorR", ",", "ageover", ",", "vaccagelow", ",", "vaccagehigh", ",", 
      RowBox[{"If", "[", 
       RowBox[{"malevacc", ",", "vaccrate", ",", "0"}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"immunefunctionrange", "[", 
     RowBox[{"priorR", ",", "ageover", ",", "maleagerange", ",", "vaccrate"}],
      "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.711129929084054*^9, 3.7111299850609455`*^9}},
 ExpressionUUID -> "b8c77106-1bfc-4cc3-ba67-8289422f03bb"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"femalecumlVacc", ",", "malecumlVacc"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"femalecumlVacc", "[", 
    RowBox[{
    "femaleagerange_", ",", "femalevacc_", ",", "vaccagelow_", ",", 
     "vaccagehigh_", ",", "vaccrate_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"femaleagerange", "\[Equal]", 
      RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"femalevacc", "&&", 
          RowBox[{"(", 
           RowBox[{
           "vaccagelow", "\[LessEqual]", "#", "\[LessEqual]", "vaccagehigh"}],
            ")"}]}], ",", "vaccrate", ",", "0"}], "]"}], "&"}], ")"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"femaleagerange", ",", 
           RowBox[{"Floor", "[", "#", "]"}]}], "]"}], ",", "vaccrate", ",", 
         "0"}], "]"}], "&"}], ")"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"malecumlVacc", "[", 
   RowBox[{
   "maleagerange_", ",", "malevacc_", ",", "vaccagelow_", ",", "vaccagehigh_",
     ",", "vaccrate_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"maleagerange", "\[Equal]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"malevacc", "&&", 
         RowBox[{"(", 
          RowBox[{
          "vaccagelow", "\[LessEqual]", "#", "\[LessEqual]", "vaccagehigh"}], 
          ")"}]}], ",", "vaccrate", ",", "0"}], "]"}], "&"}], ")"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"maleagerange", ",", 
          RowBox[{"Floor", "[", "#", "]"}]}], "]"}], ",", "vaccrate", ",", 
        "0"}], "]"}], "&"}], ")"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{
  3.7111299255899405`*^9, {3.711129995689145*^9, 3.7111300441224017`*^9}},
 ExpressionUUID -> "5f965de3-7b85-4fcd-be40-5624405c6888"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "quantifyImpact", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"quantifyImpact", "[", "\[IndentingNewLine]", 
   RowBox[{"model_", ",", 
    RowBox[{"(*", 
     RowBox[{
     "NDSolve", " ", "object", " ", "defined", " ", "for", " ", "the", " ", 
      "present", " ", "country"}], "*)"}], "\[IndentingNewLine]", "country_", 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "betaHV_", ",", 
    RowBox[{"(*", 
     RowBox[{"Vector", "-", 
      RowBox[{"borne", " ", "transmission", " ", "modifier"}]}], "*)"}], 
    "\[IndentingNewLine]", "betaMF_", ",", 
    RowBox[{"(*", 
     RowBox[{"Sexual", " ", "transmission", " ", "rate"}], "*)"}], 
    "\[IndentingNewLine]", "\n", 
    RowBox[{"vaccPars_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{"Vaccination", " ", "scenario", " ", "parameters"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"parameterOverride_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{"Optional", " ", "override", " ", "of", " ", "parameters"}], 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"startyr_:", "0"}], ",", 
    RowBox[{"endyr_:", "10"}], ",", "\n", "\[IndentingNewLine]", 
    RowBox[{"priorR_:", "0"}], ",", 
    RowBox[{"(*", 
     RowBox[{"Pre", "-", 
      RowBox[{"existing", " ", "population", " ", "immunity"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"ageover_:", "0"}], ",", 
    RowBox[{"(*", 
     RowBox[{
     "Age", " ", "above", " ", "which", " ", "individuals", " ", "have", " ", 
      "immune", " ", "memory"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"lag_:", "0"}]}], 
   RowBox[{"(*", 
    RowBox[{
    "Time", " ", "between", " ", "vaccine", " ", "availability", " ", "and", 
     " ", "outbreak", " ", "start"}], "*)"}], "\[IndentingNewLine]", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"basemodel", "=", "model"}], ",", 
      RowBox[{"forceStartI", "=", 
       RowBox[{"(", 
        RowBox[{"lag", "\[Equal]", "0"}], ")"}]}], ",", 
      RowBox[{"epistart", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"lag", "\[NotEqual]", "0"}], "&&", 
            RowBox[{"#", "\[Equal]", "lag"}]}], ",", "0.001", ",", "0"}], 
          "]"}], "&"}], ")"}]}]}], "}"}], ",", "\n", "\n", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vaccrate", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vaccrate", "/.", "vaccPars"}], "/.", 
           RowBox[{"vaccrate", "->", "0"}]}], ")"}]}], ",", 
        RowBox[{"(*", "Coverage", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vacceff", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vacceff", "/.", "vaccPars"}], "/.", 
           RowBox[{"vacceff", "->", "0"}]}], ")"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{"Vaccine", " ", "efficacy"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vaccagelow", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vaccagelow", "/.", "vaccPars"}], "/.", 
           RowBox[{"vaccagelow", "\[Rule]", "15"}]}], ")"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{"Youngest", " ", "age", " ", "to", " ", "vaccinate"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vaccagehigh", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"vaccagehigh", "/.", "vaccPars"}], "/.", 
           RowBox[{"vaccagehigh", "\[Rule]", "49"}]}], ")"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{"Oldest", " ", "age", " ", "to", " ", "vaccinate"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"malevacc", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"malevacc", "/.", "vaccPars"}], "/.", 
           RowBox[{"malevacc", "\[Rule]", "False"}]}], ")"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{"Whether", " ", "to", " ", "vaccinate", " ", "males"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"femalevacc", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"femalevacc", "/.", "vaccPars"}], "/.", 
           RowBox[{"femalevacc", "->", "False"}]}], ")"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{"Whether", " ", "to", " ", "vaccinate", " ", "females"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"maleagerange", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"maleagerange", "/.", "vaccPars"}], "/.", 
           RowBox[{"maleagerange", "\[Rule]", 
            RowBox[{"{", "}"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"femaleagerange", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"femaleagerange", "/.", "vaccPars"}], "/.", 
           RowBox[{"femaleagerange", "\[Rule]", 
            RowBox[{"{", "}"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"annualcovg", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"annualcovg", "/.", "vaccPars"}], "/.", 
           RowBox[{"annualcovg", "\[Rule]", "True"}]}], ")"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ComputeFinalTimeSeries", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"parameterOverride", ",", 
          RowBox[{"{", 
           RowBox[{"\[Eta]", "\[Rule]", "vacceff"}], "}"}], ",", 
          RowBox[{"BaseParameters", "[", 
           RowBox[{"country", ",", "betaHV", ",", "betaMF"}], "]"}]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"annualcovg", ",", "\[IndentingNewLine]", 
             RowBox[{"AnnualVacc", "[", 
              RowBox[{"vaccrate", 
               RowBox[{"(*", "Coverage", "*)"}], ",", "\[IndentingNewLine]", 
               "malevacc", 
               RowBox[{"(*", 
                RowBox[{"Vaccinate", " ", "men"}], "*)"}], ",", 
               "\[IndentingNewLine]", "femalevacc", 
               RowBox[{"(*", 
                RowBox[{"Vaccinate", " ", "women"}], "*)"}], ",", 
               "\[IndentingNewLine]", "vaccagelow", ",", "vaccagelow", ",", 
               RowBox[{"(", 
                RowBox[{"1", "&"}], ")"}]}], 
              RowBox[{"(*", 
               RowBox[{"Vaccinate", " ", "every", " ", "year"}], "*)"}], 
              "]"}], ",", "Nothing"}], "]"}], ",", "\[IndentingNewLine]", 
           "NoVaccScen"}], "}"}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "country", ",", "\[IndentingNewLine]", 
        RowBox[{"startcondsBase", "[", 
         RowBox[{"country", ",", "startyr", ",", "\[IndentingNewLine]", 
          RowBox[{"FemaleImmuneFunction", "[", 
           RowBox[{
           "femaleagerange", ",", "priorR", ",", "ageover", ",", "vaccagelow",
             ",", "vaccagehigh", ",", "femalevacc", ",", "vaccrate"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"MaleImmuneFunction", "[", 
           RowBox[{
           "maleagerange", ",", "priorR", ",", "ageover", ",", "vaccagelow", 
            ",", "vaccagehigh", ",", "malevacc", ",", "vaccrate"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"femalecumlVacc", "[", 
           RowBox[{
           "femaleagerange", ",", "femalevacc", ",", "vaccagelow", ",", 
            "vaccagehigh", ",", "vaccrate"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"malecumlVacc", "[", 
           RowBox[{
           "maleagerange", ",", "malevacc", ",", "vaccagelow", ",", 
            "vaccagehigh", ",", "vaccrate"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "startyr", ",", "endyr"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Code",
 CellChangeTimes->{{3.6847629145904675`*^9, 3.6847629694201946`*^9}, {
   3.684763001411869*^9, 3.6847630062570877`*^9}, {3.6847630527435303`*^9, 
   3.684763425354123*^9}, {3.6847635083643217`*^9, 3.684763526567835*^9}, {
   3.684763586808217*^9, 3.6847636500709267`*^9}, {3.68476380156796*^9, 
   3.684763839788124*^9}, {3.68476404473861*^9, 3.684764109928295*^9}, {
   3.6847645582338786`*^9, 3.6847647007228813`*^9}, {3.6847649562171297`*^9, 
   3.6847649772032247`*^9}, {3.684765021918293*^9, 3.684765024666889*^9}, 
   3.6847651083215075`*^9, {3.6847651546551857`*^9, 3.6847651564364443`*^9}, {
   3.6847653002076015`*^9, 3.684765315924237*^9}, {3.684765440355378*^9, 
   3.6847654413397636`*^9}, {3.68476581232965*^9, 3.6847659067820654`*^9}, {
   3.6847659632380733`*^9, 3.684765983655066*^9}, 3.684766227815091*^9, {
   3.6847663785511045`*^9, 3.6847664498571024`*^9}, {3.684766552551119*^9, 
   3.684766575455126*^9}, {3.684766936192151*^9, 3.684766962216155*^9}, {
   3.6847696575480375`*^9, 3.6847697255227947`*^9}, {3.684771445425482*^9, 
   3.6847714642591114`*^9}, {3.68477150817819*^9, 3.684771514116026*^9}, {
   3.685977350825337*^9, 3.6859773576183367`*^9}, {3.685977391449339*^9, 
   3.685977393409339*^9}, {3.6869303029986277`*^9, 3.6869303204066267`*^9}, {
   3.6869303820146317`*^9, 3.686930526326643*^9}, {3.6869329151115046`*^9, 
   3.686932919182268*^9}, {3.686933233925459*^9, 3.6869332361034575`*^9}, {
   3.6869339565978065`*^9, 3.6869339581494303`*^9}, {3.686934464151287*^9, 
   3.686934471499094*^9}, {3.6869345617930307`*^9, 3.6869345928547163`*^9}, {
   3.6869346247606287`*^9, 3.6869346770980906`*^9}, {3.686934726102643*^9, 
   3.6869347292807703`*^9}, 3.686934775354146*^9, {3.687016522095902*^9, 
   3.687016525928689*^9}, {3.6870221398495064`*^9, 3.687022162106982*^9}, {
   3.711130451478318*^9, 3.711130710941642*^9}, {3.711130753286908*^9, 
   3.711130753635105*^9}, {3.711131288008395*^9, 3.7111313749121323`*^9}, {
   3.7111314149602475`*^9, 3.711131466547476*^9}, {3.711131566108735*^9, 
   3.711131598756523*^9}, {3.711131721672257*^9, 3.711131722116062*^9}, {
   3.7111317828813653`*^9, 3.7111318152749805`*^9}, {3.711131855382534*^9, 
   3.711131995376522*^9}, {3.711132040801323*^9, 3.7111320412379045`*^9}, {
   3.7111323748782644`*^9, 3.711132436224741*^9}},
 ExpressionUUID -> "01cb6d28-31b5-4510-b56b-519c2edd8149"],

Cell[TextData[StyleBox["VACCINATION RULES",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.711220186358526*^9, 3.711220188334138*^9}},
 ExpressionUUID -> "f23ea951-ce36-423d-982f-437baa535e58"],

Cell[TextData[{
 "If ",
 StyleBox["femaleagerange",
  FontWeight->"Bold"],
 " is defined, mass vaccinate all females within the range at rate ",
 StyleBox["vaccrate",
  FontWeight->"Bold"],
 " at the model start. The same holds for ",
 StyleBox["maleagerange",
  FontWeight->"Bold"],
 ". \n\nIf ",
 StyleBox["femaleagerange",
  FontWeight->"Bold"],
 " is not defined (is {}) and if ",
 StyleBox["femalevacc",
  FontWeight->"Bold"],
 " is true, mass vaccinate all women between the ages ",
 StyleBox["vaccageLow",
  FontWeight->"Bold"],
 " and ",
 StyleBox["vaccagehigh",
  FontWeight->"Bold"],
 " at rate ",
 StyleBox["vaccrate",
  FontWeight->"Bold"],
 ". Same rule applies to men"
}], "Text",
 CellChangeTimes->{{3.711219939719449*^9, 3.7112199691619854`*^9}, {
  3.711220034387825*^9, 3.711220095297841*^9}, {3.7112203414715614`*^9, 
  3.7112203454177094`*^9}},
 ExpressionUUID -> "27c809ec-b517-464e-a181-c5b4014d3b03"],

Cell[TextData[{
 "If ",
 StyleBox["annualcovg",
  FontWeight->"Bold"],
 " is true, vaccinate men (if ",
 StyleBox["malevacc",
  FontWeight->"Bold"],
 " is true) and women (if ",
 StyleBox["femalevacc",
  FontWeight->"Bold"],
 " is true) of age ",
 StyleBox["vaccagelow",
  FontWeight->"Bold"],
 " at annual rate ",
 StyleBox["vaccrate",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.711220117834943*^9, 3.711220174050251*^9}},
 ExpressionUUID -> "31424df6-43fa-491c-9e8c-18feefa4fe54"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Setup best-fit scenarios", "Subsection",
 CellChangeTimes->{{3.7151094432240458`*^9, 3.715109452375614*^9}},
 ExpressionUUID -> "296050f5-ca4d-457f-ab29-c44673368031"],

Cell["From \[OpenCurlyDoubleQuote]CalibrationPuertoRico.nb\
\[CloseCurlyDoubleQuote] analysis", "Text",
 CellChangeTimes->{{3.7151094535631137`*^9, 3.7151094596239896`*^9}},
 ExpressionUUID -> "2e6d63b1-be0f-4bd1-857e-e3d888270d10"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"betaBestFit", "=", "0.259"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"seasonalityAmplitude", "=", 
   RowBox[{"7", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"seasonalityPhase", "=", 
    RowBox[{
     RowBox[{"-", "3"}], "*", 
     RowBox[{"Pi", "/", "10"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"seasonalityFunction", "[", "country_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"MosqBirth", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"365", "/", "7.8"}], ")"}], "*", 
     RowBox[{"mosquitoPopulation", "[", "country", "]"}], "*", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"7", "/", "10"}], "*", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"Pi", "/", "5"}], "-", 
          RowBox[{"2", "*", "Pi", "*", "t"}]}], "]"}]}]}], ")"}]}]}], 
   ")"}]}]}], "Code",
 CellChangeTimes->{{3.7151094608739386`*^9, 3.715109480558256*^9}, {
   3.7163221716559677`*^9, 3.7163221770801682`*^9}, 3.716322284407734*^9, {
   3.716470866687172*^9, 3.7164708718638697`*^9}, {3.7164709365193996`*^9, 
   3.7164709497859373`*^9}},
 ExpressionUUID -> "79b1b928-7c53-40e7-ae86-5bdad498ed5c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Run time series of vaccination impact scenarios", "Section",
 CellChangeTimes->{{3.711132156723754*^9, 3.7111321623106375`*^9}},
 ExpressionUUID -> "f28e4916-1a43-476a-b766-3666eb40ec97"],

Cell[CellGroupData[{

Cell["Run vaccine impact scenarios: no sexual transmission", "Subsection",
 CellChangeTimes->{{3.7117163285716085`*^9, 3.71171633521879*^9}},
 ExpressionUUID -> "4787be02-9763-426f-8711-483819743994"],

Cell[CellGroupData[{

Cell["Run vaccine impact scenarios - \[OpenCurlyDoubleQuote]best fit\
\[CloseCurlyDoubleQuote] attack rate", "Subsubsection",
 CellChangeTimes->{{3.7111321639558506`*^9, 3.7111321676636906`*^9}, {
  3.7117162533134317`*^9, 3.71171625734925*^9}},
 ExpressionUUID -> "0789a4df-8d80-4b93-be41-627993f465fe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7114762905327024`*^9, 3.711476293868267*^9}},
 ExpressionUUID -> "84dea54f-3062-4fce-a10d-cb18017c8b02"],

Cell[BoxData["\<\"C:\\\\Users\\\\carbon\\\\Dropbox\\\\Code\\\\Git\\\\\
ZikaVaccineModel\"\>"], "Output",
 CellChangeTimes->{3.7114762941818857`*^9, 3.7138841776478424`*^9, 
  3.7138842736232705`*^9, 3.713884519862337*^9, 3.715109419490514*^9, 
  3.716322297423795*^9, 3.716324210003165*^9, 3.7163244809915094`*^9, 
  3.716325014689993*^9, 3.7163251652248535`*^9, 3.7163256630363865`*^9},
 ExpressionUUID -> "748706e9-4af8-4aaa-a49f-c702c8fb8873"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "@", "vaccScen"}]], "Input",
 CellChangeTimes->{{3.7138845242919703`*^9, 3.7138845255084844`*^9}},
 ExpressionUUID -> "6a27a51c-1b04-4d71-89b3-6402936eff09"],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`vaccScen, StandardForm],
  ImageSizeCache->{104., {0., 15.}}]], "Output",
 CellChangeTimes->{3.713884526222706*^9, 3.7151094204592876`*^9, 
  3.716322297606855*^9, 3.7163242100656676`*^9, 3.716324481945187*^9, 
  3.716325015583626*^9, 3.7163251653179197`*^9, 3.716325664322299*^9},
 ExpressionUUID -> "acdfa068-8db4-4552-99cc-a00bc8c815ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vaccineTimeSeriesScenarios", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"country", "=", "\"\<Puerto Rico\>\""}], ",", 
        RowBox[{"betaHV", "=", "betaBestFit"}], ",", 
        RowBox[{"betaMF", "=", "0.1"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"coremodel", "=", 
          RowBox[{"Get", "[", 
           RowBox[{
           "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"vaccScen", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
             "\[IndentingNewLine]", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"data", "=", 
                 RowBox[{"quantifyImpact", "[", 
                  RowBox[{
                  "coremodel", ",", "country", ",", "betaHV", ",", "betaMF", 
                   ",", 
                   RowBox[{"vaccScen", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"MosqBirth", "\[Rule]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"365", "/", "7.8"}], ")"}], "*", 
                    RowBox[{"mosquitoPopulation", "[", "country", "]"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"7", "/", "10"}], "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"Pi", "/", "5"}], "-", 
                    RowBox[{"2", "*", "Pi", "*", "t"}]}], "]"}]}]}], 
                    ")"}]}]}], "}"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Association", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"\"\<allInfections\>\"", "\[Rule]", 
                   RowBox[{"pullAllInfections", "@", "data"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
                   RowBox[{"pullPrenatalInfections", "[", 
                    RowBox[{"data", ",", "country"}], "]"}]}]}], 
                 "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]",
               "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"vaccScen", ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<NoVaccination\>\"", ",", 
                 RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<WHOfemale\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vaccrate", "\[Rule]", "0.9"}], ",", 
                   RowBox[{"vacceff", "\[Rule]", "0.75"}], ",", 
                   RowBox[{"vaccagelow", "\[Rule]", "15"}], ",", 
                   RowBox[{"vaccagehigh", "\[Rule]", "49"}], ",", 
                   RowBox[{"malevacc", "\[Rule]", "False"}], ",", 
                   RowBox[{"femalevacc", "\[Rule]", "True"}], ",", 
                   RowBox[{"annualcovg", "\[Rule]", "True"}]}], "}"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<WHOall\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vaccrate", "\[Rule]", "0.9"}], ",", 
                   RowBox[{"vacceff", "\[Rule]", "0.75"}], ",", 
                   RowBox[{"vaccagelow", "\[Rule]", "15"}], ",", 
                   RowBox[{"vaccagehigh", "\[Rule]", "49"}], ",", 
                   RowBox[{"malevacc", "\[Rule]", "True"}], ",", 
                   RowBox[{"femalevacc", "\[Rule]", "True"}], ",", 
                   RowBox[{"annualcovg", "\[Rule]", "True"}]}], "}"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<allfemale\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vaccrate", "\[Rule]", "0.9"}], ",", 
                   RowBox[{"vacceff", "\[Rule]", "0.75"}], ",", 
                   RowBox[{"vaccagelow", "\[Rule]", "9"}], ",", 
                   RowBox[{"vaccagehigh", "\[Rule]", "100"}], ",", 
                   RowBox[{"malevacc", "\[Rule]", "False"}], ",", 
                   RowBox[{"femalevacc", "\[Rule]", "True"}], ",", 
                   RowBox[{"annualcovg", "\[Rule]", "True"}]}], "}"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<allpopulation\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"vaccrate", "\[Rule]", "0.9"}], ",", 
                   RowBox[{"vacceff", "\[Rule]", "0.75"}], ",", 
                   RowBox[{"vaccagelow", "\[Rule]", "9"}], ",", 
                   RowBox[{"vaccagehigh", "\[Rule]", "100"}], ",", 
                   RowBox[{"malevacc", "\[Rule]", "True"}], ",", 
                   RowBox[{"femalevacc", "\[Rule]", "True"}], ",", 
                   RowBox[{"annualcovg", "\[Rule]", "True"}]}], "}"}]}], 
                "}"}]}], "\[IndentingNewLine]", "}"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7111321774987893`*^9, 3.711132191279798*^9}, {
   3.7111322306035113`*^9, 3.7111323522797003`*^9}, {3.711132464730587*^9, 
   3.711132467007018*^9}, {3.7111325008470564`*^9, 3.71113257366261*^9}, {
   3.7111326680279865`*^9, 3.711132722364884*^9}, {3.711132847957015*^9, 
   3.71113287825154*^9}, {3.7111330171753664`*^9, 3.711133042375311*^9}, {
   3.7111368221735907`*^9, 3.711136828128333*^9}, {3.711476116683987*^9, 
   3.711476135858944*^9}, {3.7114762092351694`*^9, 3.7114762562748637`*^9}, {
   3.7138843058993163`*^9, 3.7138843505230722`*^9}, {3.715109490781182*^9, 
   3.7151095267703066`*^9}, {3.7151095746212716`*^9, 
   3.7151096243430777`*^9}, {3.7163222093415737`*^9, 3.7163222447463493`*^9}, 
   3.7163244656456337`*^9, {3.7163251674314194`*^9, 3.716325220206826*^9}},
 ExpressionUUID -> "6b3c0341-9bbb-4b3b-8725-3e706cb5254f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"133.51048834615534`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.7111328709127617`*^9, 3.711132946894329*^9, 
  3.7111331108662434`*^9, 3.7114758167313433`*^9, 3.711476287608985*^9, 
  3.7114763596268167`*^9, 3.7138844301437855`*^9, 3.7138846026861887`*^9, 
  3.7151097204615808`*^9, 3.716322429271447*^9, 3.7163244143678265`*^9, 
  3.7163246586948647`*^9, 3.716325389964476*^9, 3.7163258003467236`*^9},
 ExpressionUUID -> "a9a5a55c-34f7-472b-8fbc-7ae3263afde6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\</GeneratedResults/VaccineImpactTimeSeries\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7114760001542125`*^9, 3.7114760189992886`*^9}},
 ExpressionUUID -> "4da76c2d-8713-4a93-a8a4-4c140ba53e05"],

Cell[BoxData["\<\"C:\\\\Users\\\\carbon\\\\Dropbox\\\\Code\\\\Git\\\\\
ZikaVaccineModel\\\\GeneratedResults\\\\VaccineImpactTimeSeries\"\>"], \
"Output",
 CellChangeTimes->{{3.7114760122638025`*^9, 3.7114760193586664`*^9}, 
   3.711476365824461*^9, 3.713884432289296*^9, 3.7138846766596193`*^9, 
   3.715109844785929*^9, 3.716322429396448*^9, 3.7163244144313707`*^9, 
   3.7163258004277744`*^9},
 ExpressionUUID -> "6c50bd8e-cdf3-475e-966a-84e78c732e7a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Put", "[", 
   RowBox[{
   "vaccineTimeSeriesScenarios", ",", 
    "\"\<vaccineTimeSeriesScenarios.dat\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7114757634413614`*^9, 3.711475767499926*^9}},
 ExpressionUUID -> "5d17dcef-39da-4514-830c-c8b0c38640c3"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Run prior immunity / coverage contour scenarios", "Section",
 CellChangeTimes->{{3.7117331308761435`*^9, 3.7117331495179887`*^9}},
 ExpressionUUID -> "733c7398-fc64-47d0-82bf-e6a698341f34"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", " ", 
   RowBox[{"PRIOR", " ", "COVERAGE", " ", "SCENARIO"}], " ", "*)"}], 
  "\n"}]], "Code",
 CellChangeTimes->{{3.711733152267993*^9, 3.711733159580187*^9}},
 ExpressionUUID -> "bb7ad88e-2388-4784-92c2-5bf3b84ab011"],

Cell[CellGroupData[{

Cell["Setup code", "Subsubsection",
 CellChangeTimes->{{3.7112192748980975`*^9, 3.7112192766403723`*^9}, {
  3.711226002598155*^9, 3.7112260030327415`*^9}},
 ExpressionUUID -> "4c4f8b6e-48ac-4355-b9af-5a5276a7a523"],

Cell["\<\
Assumptions / specifications for the \[OpenCurlyDoubleQuote]cases averted per \
vaccine\[CloseCurlyDoubleQuote] analysis:
1) Use a small vaccination rate of 0.01 to minimize nonlinear impact
2) Disable annual coverage, so only consider one-time mass vaccination\
\>", "Text",
 CellChangeTimes->{{3.711297748134208*^9, 3.711297804621227*^9}},
 ExpressionUUID -> "5728e919-a7d3-4720-bb0a-e755462c4783"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "runFrontierScenarios"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runFrontierScenarios", "[", 
   RowBox[{
   "country_", ",", "attackRate_", ",", "basemodel_", ",", "vrate_", ",", 
    "veff_", ",", "mvacc_", ",", "vlow_", ",", "vhigh_", ",", 
    RowBox[{"maleAgeRange_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"femaleAgeRange_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"endyr_:", "10"}], ",", 
    RowBox[{"priorR_:", "0"}], ",", 
    RowBox[{"ageover_:", "0"}], ",", 
    RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"betaHV", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"attackRate", "\[Equal]", "\"\<Best fit\>\""}], ",", 
         "betaBestFit", ",", 
         RowBox[{
          RowBox[{"calibratedTransmissionRates", "[", "country", "]"}], "[", 
          "attackRate", "]"}]}], "]"}]}], ",", 
      RowBox[{"betaMF", "=", "0.1"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"quantifyImpact", "[", "\[IndentingNewLine]", 
     RowBox[{
     "basemodel", ",", "country", ",", "betaHV", ",", "betaMF", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Vaccination", " ", "scenario", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"annualcovg", "\[Rule]", "False"}], ",", 
        RowBox[{"vaccrate", "\[Rule]", "vrate"}], ",", 
        RowBox[{"vacceff", "\[Rule]", "veff"}], ",", 
        RowBox[{"femalevacc", "\[Rule]", "True"}], ",", 
        RowBox[{"malevacc", "\[Rule]", "mvacc"}], ",", 
        RowBox[{"vaccagelow", "\[Rule]", "vlow"}], ",", 
        RowBox[{"vaccagehigh", "\[Rule]", "vhigh"}], ",", 
        RowBox[{"maleagerange", "\[Rule]", "maleAgeRange"}], ",", 
        RowBox[{"femaleagerange", "\[Rule]", "femaleAgeRange"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"seasonalityFunction", "[", "country", "]"}], "}"}], ",", 
      "\[IndentingNewLine]", "0", ",", "endyr", ",", "priorR", ",", "ageover",
       ",", "lag"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.7112193528034077`*^9, 3.7112193742970552`*^9}, {
  3.7112194261807623`*^9, 3.7112194498964*^9}, {3.711219484971417*^9, 
  3.711219562406809*^9}, {3.7112196837383394`*^9, 3.71121971679076*^9}, {
  3.7112204039790034`*^9, 3.711220455325137*^9}, {3.711220517738079*^9, 
  3.7112205196906853`*^9}, {3.7112206371423955`*^9, 3.7112206686070986`*^9}, {
  3.7112207024726315`*^9, 3.7112207177257037`*^9}, {3.7112208822246675`*^9, 
  3.71122088313743*^9}, {3.7112977448524513`*^9, 3.71129774521634*^9}, {
  3.7112978098442154`*^9, 3.7112978676094847`*^9}, {3.711297924918034*^9, 
  3.7112979297730284`*^9}, {3.7113064883163433`*^9, 3.711306580334937*^9}, {
  3.7113080189791613`*^9, 3.711308057092841*^9}, {3.7151099164704742`*^9, 
  3.715109922973793*^9}, {3.7164709874416428`*^9, 3.7164710427067704`*^9}, {
  3.7164712148029404`*^9, 3.7164712298072805`*^9}},
 ExpressionUUID -> "d2e34ddf-b315-4ae2-a692-0339ac333f4f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup age group targeting", "Subsubsection",
 CellChangeTimes->{{3.7112968895988717`*^9, 3.711296892053542*^9}, 
   3.711308485301056*^9},
 ExpressionUUID -> "9ff422d3-491a-4953-af5f-bdd52602e97d"],

Cell["\<\
Compute age group targeting for Puerto Rico, under the \[OpenCurlyQuote]best \
fit\[CloseCurlyQuote] attack rate, 90% coverage with 75% efficacy vaccine\
\>", "Text",
 CellChangeTimes->{{3.7112848777531595`*^9, 3.711284900497135*^9}},
 ExpressionUUID -> "da7bd87a-485f-43c6-80da-6cee04ec28f5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7112961049492188`*^9, 3.711296108474163*^9}},
 ExpressionUUID -> "7485d6b1-9318-4616-9348-54d5a8d81240"],

Cell[BoxData["\<\"D:\\\\Dropbox\\\\Projects\\\\Zika vaccine\\\\Code\"\>"], \
"Output",
 CellChangeTimes->{3.711298126338483*^9, 3.7113040119719906`*^9, 
  3.711461944048524*^9, 3.7117342427780037`*^9, 3.7117404567127047`*^9},
 ExpressionUUID -> "f15e0176-ef24-4021-b245-32bc6ba34312"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "@", "vaccResultsPriorImmunity"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vaccResultsPriorImmunity", "[", 
    RowBox[{"country_", ",", "priorR_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"veff", "=", "0.75"}], ",", 
       RowBox[{"mvacc", "=", "False"}], ",", 
       RowBox[{"vlow", "=", "9"}], ",", 
       RowBox[{"vhigh", "=", "49"}], ",", 
       RowBox[{"endyr", "=", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", "\n", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Association", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<attR\>\"", "\[Rule]", "attR"}], ",", 
              RowBox[{"\"\<vrate\>\"", "\[Rule]", "vrate"}], ",", 
              RowBox[{"\"\<priorR\>\"", "->", "priorR"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Results\>\"", "\[Rule]", "\[IndentingNewLine]", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"data", "=", 
                   RowBox[{"runFrontierScenarios", "[", 
                    RowBox[{
                    "country", ",", "attR", ",", "basemodel", ",", "vrate", 
                    ",", "veff", ",", "mvacc", ",", "vlow", ",", "vhigh", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", "endyr", ",", "priorR"}], 
                    "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Association", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
                    RowBox[{"pullAllVaccines", "[", 
                    RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
                    RowBox[{"pullPrenatalInfections", "[", 
                    RowBox[{
                    "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
                    RowBox[{"pullPregnancies", "[", 
                    RowBox[{
                    "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<population\>\"", "\[Rule]", 
                    RowBox[{"pullAllPopulation", "[", 
                    RowBox[{"data", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], "\n", "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"attR", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0.05", ",", "0.55", ",", "0.05"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vrate", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0.5", ",", "0.9"}], "}"}]}], "}"}]}], "]"}], 
         ",", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.711219521342289*^9, 3.7112195798893557`*^9}, {
   3.7112204911736784`*^9, 3.711220510854018*^9}, {3.7112205648339515`*^9, 
   3.7112205732561655`*^9}, {3.7112207275745983`*^9, 3.711220761200269*^9}, {
   3.7112211038562737`*^9, 3.711221126125988*^9}, {3.711221157796819*^9, 
   3.7112213529884443`*^9}, {3.7112214737320886`*^9, 
   3.7112216005815125`*^9}, {3.711221646669015*^9, 3.711221662478444*^9}, {
   3.7112218609755125`*^9, 3.7112218665180483`*^9}, {3.7112219046675158`*^9, 
   3.711221916157387*^9}, {3.7112227992655044`*^9, 3.7112228056536245`*^9}, {
   3.7112847040913877`*^9, 3.7112847577223864`*^9}, {3.711284812490117*^9, 
   3.7112848658191395`*^9}, 3.7112976952303095`*^9, {3.711303892888295*^9, 
   3.7113039183902674`*^9}, {3.7113067737014728`*^9, 3.711306778503993*^9}, {
   3.7113083050615215`*^9, 3.711308322855015*^9}, {3.7113086918642073`*^9, 
   3.7113086970055556`*^9}, {3.7113123015775733`*^9, 
   3.7113123054444995`*^9}, {3.7117332139906435`*^9, 3.711733378005587*^9}, {
   3.7117334224656363`*^9, 3.7117335018313255`*^9}, {3.7117335584141226`*^9, 
   3.711733613392913*^9}, {3.711733785719662*^9, 3.711733798230301*^9}, {
   3.71173430120838*^9, 3.711734306475072*^9}, {3.711734931489503*^9, 
   3.7117349357527933`*^9}, {3.7117349781904182`*^9, 3.711735001082056*^9}, {
   3.711735405057421*^9, 3.711735408296402*^9}, {3.711740465641075*^9, 
   3.711740465873348*^9}, {3.7117405213974237`*^9, 3.71174052261138*^9}, 
   3.7117407121966033`*^9, {3.713886052974888*^9, 3.7138860638303223`*^9}, {
   3.7164710767754955`*^9, 3.7164710772911263`*^9}, {3.7164711899693813`*^9, 
   3.7164711993747997`*^9}},
 ExpressionUUID -> "f3ba62ab-9cc5-4301-80b4-dfe7a139a17b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run on desktop", "Subsubsection",
 CellChangeTimes->{{3.711734201578658*^9, 3.7117342034364777`*^9}},
 ExpressionUUID -> "bfabeff9-948b-4472-b4c0-3b69b8d52a7d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"{", 
   RowBox[{"attR", ",", "vrate", ",", "priorR", ",", "country"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7112850061164484`*^9, 3.711285016609449*^9}, {
  3.711734233648608*^9, 3.711734239081314*^9}},
 ExpressionUUID -> "b64d7282-0621-40f3-9f29-4b61d7f50502"],

Cell[BoxData[
 DynamicBox[
  ToBoxes[{$CellContext`attR, $CellContext`vrate, $CellContext`priorR, \
$CellContext`country}, StandardForm],
  ImageSizeCache->{403., {5., 16.}}]], "Output",
 CellChangeTimes->{
  3.711285016964451*^9, 3.711298095203562*^9, 3.711461944001624*^9, 
   3.7117342523962035`*^9, 3.7117343090546846`*^9, 3.711734817806873*^9, 
   3.711735003044307*^9, 3.7117354128626137`*^9, {3.7117405175454073`*^9, 
   3.711740526564648*^9}, 3.711740714791541*^9, 3.711740813074596*^9},
 ExpressionUUID -> "9363953a-4c26-4991-839b-9c85e697e886"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7117345540984983`*^9, 3.7117345576620784`*^9}},
 ExpressionUUID -> "4cd980c9-4e0d-496f-a49a-260320dc4f98"],

Cell[BoxData["\<\"D:\\\\Dropbox\\\\Projects\\\\Zika vaccine\\\\Code\"\>"], \
"Output",
 CellChangeTimes->{
  3.7117345580995455`*^9, 3.7117346825971675`*^9, {3.711734823720874*^9, 
   3.7117348434558744`*^9}, 3.711735005536621*^9, 3.711735201739582*^9, 
   3.7117354161396112`*^9, 3.7117407178757167`*^9, 3.7117408182611647`*^9},
 ExpressionUUID -> "75f66704-7a66-4f25-b7b7-cc0adff11de5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"result", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"vaccResultsPriorImmunity", "[", 
              RowBox[{"country", ",", "priorR"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"priorR", ",", 
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "0.95", ",", "0.05"}], "]"}]}], "}"}], ",", 
             "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SetDirectory", "[", 
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<GeneratedResults/PriorRcontours\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Put", "[", 
           RowBox[{"result", ",", 
            RowBox[{"(", 
             RowBox[{
             "\"\<results\>\"", "<>", "\"\<_\>\"", "<>", "country", "<>", 
              "\"\<.dat\>\""}], ")"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"ResetDirectory", "[", "]"}], ";"}], "\[IndentingNewLine]", 
         ")"}]}], "]"}], "\[IndentingNewLine]", ")"}], ",", 
     RowBox[{"{", 
      RowBox[{"country", ",", 
       RowBox[{"{", "\"\<Puerto Rico\>\"", "}"}]}], 
      RowBox[{"(*", "CountryNames", "*)"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.711734358640956*^9, 3.711734369530511*^9}, {
   3.7117343998596945`*^9, 3.7117344037904444`*^9}, {3.711734438064399*^9, 
   3.7117344908456345`*^9}, {3.7117345367616653`*^9, 3.711734608038929*^9}, 
   3.7117346787105846`*^9, {3.7117348401698756`*^9, 3.7117348419929085`*^9}, {
   3.7117350828904076`*^9, 3.7117350845044017`*^9}, {3.7117351919696207`*^9, 
   3.7117351972247047`*^9}, {3.711735305442328*^9, 3.7117353101047444`*^9}, {
   3.7117405369753156`*^9, 3.7117405500035524`*^9}, {3.71174075877802*^9, 
   3.711740796489622*^9}, {3.716471168452565*^9, 3.7164711756797533`*^9}},
 ExpressionUUID -> "c9a078aa-5e28-49bf-88d8-06cfeadafcec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7865.189522686053`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.711740667729228*^9, 3.7117407509559965`*^9, 
  3.7117486839398813`*^9},
 ExpressionUUID -> "16cb7d3a-91df-40bf-8f53-2233b9c09460"]
}, Open  ]],

Cell["\<\
Test run: model took 104s for attack rate range, with vrate, priorR, and \
country only sampling one value each\
\>", "Text",
 CellChangeTimes->{{3.711740730241757*^9, 3.7117407472338324`*^9}},
 ExpressionUUID -> "f445318c-8b71-4d24-8f0b-275eec20ed47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "0.95", ",", "0.05"}], "]"}], "]"}], "*", "4", "*", 
   RowBox[{"104", "/", "3600"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7117405652882657`*^9, 3.7117405759434924`*^9}, {
  3.711740679305015*^9, 3.7117406869152865`*^9}, {3.7117407749359903`*^9, 
  3.711740800330996*^9}},
 ExpressionUUID -> "230b5cd4-a665-4cf4-b7c8-e09b0ac03a2e"],

Cell[BoxData["2.311111111111111`"], "Output",
 CellChangeTimes->{{3.7117406804275*^9, 3.7117406872743125`*^9}, {
  3.71174077745754*^9, 3.7117408007452374`*^9}},
 ExpressionUUID -> "e5e2e40a-fa9b-476b-b182-5e6e8dbdab59"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cluster run", "Subsubsection",
 CellChangeTimes->{{3.7117336210711575`*^9, 3.711733622152815*^9}},
 ExpressionUUID -> "2cd6180e-56fc-48c5-a525-bce5498bc154"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"country", "=", 
     RowBox[{"CountryNames", "[", 
      RowBox[{"[", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"$CommandLine", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Put", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"vaccResultsPriorImmunity", "[", 
         RowBox[{"country", ",", "priorR"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"priorR", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "0.95", ",", "0.05"}], "]"}]}], "}"}], ",", 
        "1"}], "]"}], "]"}], ",", 
     RowBox[{"(", 
      RowBox[{
      "\"\<results\>\"", "<>", "\"\<_\>\"", "<>", "country", "<>", 
       "\"\<.dat\>\""}], ")"}]}], "]"}]}], "]"}]], "Code",
 CellChangeTimes->{{3.711733627668377*^9, 3.7117337546350894`*^9}, {
   3.7117346373906765`*^9, 3.71173464952208*^9}, 3.711913648686295*^9, {
   3.7164711408638315`*^9, 3.716471153427599*^9}},
 ExpressionUUID -> "eeb8bdf9-facd-432a-8832-05033e182656"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Run age-specific scenarios", "Section",
 CellChangeTimes->{{3.71129679491015*^9, 3.7112967988179555`*^9}},
 ExpressionUUID -> "fd693f12-10e1-4646-8b45-82ca221001ac"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Age", "-", 
    RowBox[{"specific", " ", "scenarios", " ", "for", " ", "frontier"}]}], 
   " ", "*)"}], "\n"}]], "Code",
 CellChangeTimes->{{3.7119114204279113`*^9, 3.711911450113465*^9}},
 ExpressionUUID -> "8fed0656-81bc-4883-8ac2-92e3f3ce6611"],

Cell[CellGroupData[{

Cell["Setup", "Subsection",
 CellChangeTimes->{{3.711472800888375*^9, 3.7114728013102536`*^9}},
 ExpressionUUID -> "93941901-318b-4a96-8132-2555e69841da"],

Cell[CellGroupData[{

Cell["Setup code", "Subsubsection",
 CellChangeTimes->{{3.7112192748980975`*^9, 3.7112192766403723`*^9}, {
  3.711226002598155*^9, 3.7112260030327415`*^9}},
 ExpressionUUID -> "0e979160-e1c4-4944-81b9-06c95ed963d1"],

Cell["\<\
Assumptions / specifications for the \[OpenCurlyDoubleQuote]cases averted per \
vaccine\[CloseCurlyDoubleQuote] analysis:
1) Use a small vaccination rate of 0.01 to minimize nonlinear impact
2) Disable annual coverage, so only consider one-time mass vaccination\
\>", "Text",
 CellChangeTimes->{{3.711297748134208*^9, 3.711297804621227*^9}},
 ExpressionUUID -> "1a2b66cb-b373-449f-ac67-83d066019ce3"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "runFrontierScenarios"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runFrontierScenarios", "[", 
   RowBox[{
   "country_", ",", "attackRate_", ",", "basemodel_", ",", "vrate_", ",", 
    "veff_", ",", "mvacc_", ",", "vlow_", ",", "vhigh_", ",", 
    RowBox[{"maleAgeRange_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"femaleAgeRange_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"endyr_:", "10"}], ",", 
    RowBox[{"priorR_:", "0"}], ",", 
    RowBox[{"ageover_:", "0"}], ",", 
    RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"betaHV", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"attackRate", "\[Equal]", "\"\<Best fit\>\""}], ",", 
         "betaBestFit", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"calibratedTransmissionRates", "[", "country", "]"}], "[", 
          "attackRate", "]"}]}], "]"}]}], ",", 
      RowBox[{"betaMF", "=", "0.1"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"quantifyImpact", "[", "\[IndentingNewLine]", 
     RowBox[{
     "basemodel", ",", "country", ",", "betaHV", ",", "betaMF", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Vaccination", " ", "scenario", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"annualcovg", "\[Rule]", "False"}], ",", 
        RowBox[{"vaccrate", "\[Rule]", "vrate"}], ",", 
        RowBox[{"vacceff", "\[Rule]", "veff"}], ",", 
        RowBox[{"femalevacc", "\[Rule]", "True"}], ",", 
        RowBox[{"malevacc", "\[Rule]", "mvacc"}], ",", 
        RowBox[{"vaccagelow", "\[Rule]", "vlow"}], ",", 
        RowBox[{"vaccagehigh", "\[Rule]", "vhigh"}], ",", 
        RowBox[{"maleagerange", "\[Rule]", "maleAgeRange"}], ",", 
        RowBox[{"femaleagerange", "\[Rule]", "femaleAgeRange"}]}], "}"}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"seasonalityFunction", "[", "country", "]"}], "}"}], ",", 
      "\[IndentingNewLine]", "0", ",", "endyr", ",", "priorR", ",", "ageover",
       ",", "lag"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ3bJV8vK0Za8dqxpPXgXR50643gHR/utt7oPom6Lz
H4PoKSy+b8HqFpT/AdEvfGcyTAfS/4Prw0B0W/qrGBAdMW97CoiWkPoGphv7
lhSD6KjcyeUg+oz8+WoQ/d1iey2IrjJwnwSir6SmgGkPd2mpvUDa6Y0amL7A
bK0Eop81FGuC6M6EuQYgetkeC0MQXSPPFX8Q5O7tXVkg2is0Xu4QkO77oaQM
oletmtTXuOa146dVU8G0alz6dBAdEV8Aphf5C1wE0fnSwmD6x6sf9UzrXjtm
PXnbAKIbv3/eNnsDMDyClHeD6IR3O/aD6MPaHQdBNADweLN9
  "],
 ExpressionUUID -> "cc8be1b1-6ae5-4e91-adac-d0e02d8949ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup no vaccine scenarios", "Subsubsection",
 CellChangeTimes->{{3.7112260178629885`*^9, 3.711226019249879*^9}, {
  3.711296861071702*^9, 3.711296862330357*^9}, {3.7113084818879633`*^9, 
  3.7113084822858057`*^9}},
 ExpressionUUID -> "7c7ddbd6-075a-4ac8-baf5-f58a279fd8f0"],

Cell["Compute no-vaccination prenatal infections", "Text",
 CellChangeTimes->{{3.7112220053102074`*^9, 3.7112220108539124`*^9}},
 ExpressionUUID -> "9e34e12b-1a48-4f1b-8a19-6467567e0e21"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "noVaccineResult"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"noVaccineResult", "[", 
    RowBox[{"country_", ",", "attR_", ",", 
     RowBox[{"lag_:", "0"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vrate", "=", "0"}], ",", 
       RowBox[{"veff", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Association", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<LowAge\>\"", "\[Rule]", "0"}], ",", 
          RowBox[{"\"\<HighAge\>\"", "\[Rule]", "0"}], ",", 
          RowBox[{"\"\<MaleVaccination\>\"", "\[Rule]", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Results\>\"", "\[Rule]", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"data", "=", 
               RowBox[{"runFrontierScenarios", "[", 
                RowBox[{
                "country", ",", "attR", ",", "basemodel", ",", "vrate", ",", 
                 "veff", ",", "False", ",", "100", ",", "100", ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"lag", "\[Equal]", "0"}], ",", "10", ",", "15"}], 
                  "]"}], ",", "0", ",", "0", ",", "lag"}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
                 RowBox[{"pullAllVaccines", "[", 
                  RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
                 RowBox[{"pullPrenatalInfections", "[", 
                  RowBox[{
                  "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
                 RowBox[{"pullPregnancies", "[", 
                  RowBox[{
                  "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<population\>\"", "\[Rule]", 
                 RowBox[{"pullAllPopulation", "[", 
                  RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}]}],
                "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.711221928788578*^9, 3.711221991516551*^9}, {
   3.7112960829671817`*^9, 3.7112960987640953`*^9}, {3.711296155616229*^9, 
   3.7112961582889895`*^9}, 3.7112976998008423`*^9, {3.711297939968589*^9, 
   3.7112979448399973`*^9}, {3.711303257380259*^9, 3.7113032823952026`*^9}, {
   3.711306629586955*^9, 3.7113066402770796`*^9}, {3.7113080939804907`*^9, 
   3.7113081281511583`*^9}, {3.716472231563629*^9, 3.7164722354710417`*^9}},
 ExpressionUUID -> "927a3bb2-f8b9-4938-8dcb-ec3a9e3a95d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup age group targeting", "Subsubsection",
 CellChangeTimes->{{3.7112968895988717`*^9, 3.711296892053542*^9}, 
   3.711308485301056*^9},
 ExpressionUUID -> "b3e62018-8ce7-4b96-bdb4-84186f9e255a"],

Cell["\<\
Compute age group targeting for Puerto Rico, under the \[OpenCurlyQuote]best \
fit\[CloseCurlyQuote] attack rate, 90% coverage with 75% efficacy vaccine\
\>", "Text",
 CellChangeTimes->{{3.7112848777531595`*^9, 3.711284900497135*^9}},
 ExpressionUUID -> "39b36684-1fe7-4c96-823a-d5d6c2ee6e32"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "vaccResultsFrontier"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vaccResultsFrontier", "[", 
    RowBox[{"country_", ",", "attR_", ",", 
     RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vrate", "=", "0.9"}], ",", 
       RowBox[{"veff", "=", "0.75"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Association", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<LowAge\>\"", "\[Rule]", "vlow"}], ",", 
              RowBox[{"\"\<HighAge\>\"", "\[Rule]", "vhigh"}], ",", 
              RowBox[{"\"\<MaleVaccination\>\"", "\[Rule]", "mvacc"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Results\>\"", "\[Rule]", "\[IndentingNewLine]", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"data", "=", 
                   RowBox[{"runFrontierScenarios", "[", 
                    RowBox[{
                    "country", ",", "attR", ",", "basemodel", ",", "vrate", 
                    ",", "veff", ",", "mvacc", ",", "vlow", ",", "vhigh", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"lag", "\[Equal]", "0"}], ",", "10", ",", "15"}], 
                    "]"}], ",", "0", ",", "0", ",", "lag"}], "]"}]}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Association", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
                    RowBox[{"pullAllVaccines", "[", 
                    RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
                    RowBox[{"pullPrenatalInfections", "[", 
                    RowBox[{
                    "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
                    RowBox[{"pullPregnancies", "[", 
                    RowBox[{
                    "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<population\>\"", "\[Rule]", 
                    RowBox[{"pullAllPopulation", "[", 
                    RowBox[{"data", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"mvacc", ",", 
             RowBox[{"{", 
              RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"vlow", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "45", ",", "5"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"vhigh", ",", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"vlow", "+", "4"}], ",", "49", ",", "5"}], "]"}]}], 
            "}"}]}], "]"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.711219521342289*^9, 3.7112195798893557`*^9}, {
   3.7112204911736784`*^9, 3.711220510854018*^9}, {3.7112205648339515`*^9, 
   3.7112205732561655`*^9}, {3.7112207275745983`*^9, 3.711220761200269*^9}, {
   3.7112211038562737`*^9, 3.711221126125988*^9}, {3.711221157796819*^9, 
   3.7112213529884443`*^9}, {3.7112214737320886`*^9, 
   3.7112216005815125`*^9}, {3.711221646669015*^9, 3.711221662478444*^9}, {
   3.7112218609755125`*^9, 3.7112218665180483`*^9}, {3.7112219046675158`*^9, 
   3.711221916157387*^9}, {3.7112227992655044`*^9, 3.7112228056536245`*^9}, {
   3.7112847040913877`*^9, 3.7112847577223864`*^9}, {3.711284812490117*^9, 
   3.7112848658191395`*^9}, 3.7112976952303095`*^9, {3.711303892888295*^9, 
   3.7113039183902674`*^9}, {3.7113067737014728`*^9, 3.711306778503993*^9}, {
   3.7113083050615215`*^9, 3.711308322855015*^9}, {3.7113086918642073`*^9, 
   3.7113086970055556`*^9}, {3.7113123015775733`*^9, 3.7113123054444995`*^9}, 
   3.711804615512993*^9, {3.7164722195683403`*^9, 3.716472224394517*^9}, {
   3.716472590848653*^9, 3.7164725912246723`*^9}},
 ExpressionUUID -> "6fcce3bd-9b09-427f-b739-758d397d47f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup 5yr group targeting", "Subsubsection",
 CellChangeTimes->{{3.7112968895988717`*^9, 3.711296892053542*^9}, 
   3.711308485301056*^9, {3.716472617658258*^9, 3.716472618050284*^9}},
 ExpressionUUID -> "6cda7ab0-c8a2-46f2-9fdf-d6a481763f20"],

Cell["\<\
Compute age group targeting in 5yr age groups, 1% coverage with 75% efficacy \
vaccine\
\>", "Text",
 CellChangeTimes->{{3.7112848777531595`*^9, 3.711284900497135*^9}, {
  3.716472621654507*^9, 3.716472643110087*^9}},
 ExpressionUUID -> "4e1b29bb-5a94-495b-b865-d576e518c09f"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "vaccResults5yr"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vaccResults5yr", "[", 
    RowBox[{"country_", ",", "attR_", ",", 
     RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vrate", "=", "0.01"}], ",", 
       RowBox[{"veff", "=", "0.75"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Association", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<LowAge\>\"", "\[Rule]", "vlow"}], ",", 
              RowBox[{"\"\<HighAge\>\"", "\[Rule]", "vhigh"}], ",", 
              RowBox[{"\"\<MaleVaccination\>\"", "\[Rule]", "mvacc"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Results\>\"", "\[Rule]", "\[IndentingNewLine]", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"data", "=", 
                   RowBox[{"runFrontierScenarios", "[", 
                    RowBox[{
                    "country", ",", "attR", ",", "basemodel", ",", "vrate", 
                    ",", "veff", ",", "mvacc", ",", "vlow", ",", "vhigh", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"lag", "\[Equal]", "0"}], ",", "10", ",", "15"}], 
                    "]"}], ",", "0", ",", "0", ",", "lag"}], "]"}]}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Association", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
                    RowBox[{"pullAllVaccines", "[", 
                    RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
                    RowBox[{"pullPrenatalInfections", "[", 
                    RowBox[{
                    "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
                    RowBox[{"pullPregnancies", "[", 
                    RowBox[{
                    "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<population\>\"", "\[Rule]", 
                    RowBox[{"pullAllPopulation", "[", 
                    RowBox[{"data", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"mvacc", ",", 
             RowBox[{"{", "False", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"vlow", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"10", ",", "45", ",", "5"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"vhigh", ",", 
             RowBox[{"{", 
              RowBox[{"vlow", "+", "4"}], "}"}]}], "}"}]}], "]"}], ",", "2"}],
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.711219521342289*^9, 3.7112195798893557`*^9}, {
   3.7112204911736784`*^9, 3.711220510854018*^9}, {3.7112205648339515`*^9, 
   3.7112205732561655`*^9}, {3.7112207275745983`*^9, 3.711220761200269*^9}, {
   3.7112211038562737`*^9, 3.711221126125988*^9}, {3.711221157796819*^9, 
   3.7112213529884443`*^9}, {3.7112214737320886`*^9, 
   3.7112216005815125`*^9}, {3.711221646669015*^9, 3.711221662478444*^9}, {
   3.7112218609755125`*^9, 3.7112218665180483`*^9}, {3.7112219046675158`*^9, 
   3.711221916157387*^9}, {3.7112227992655044`*^9, 3.7112228056536245`*^9}, {
   3.7112847040913877`*^9, 3.7112847577223864`*^9}, {3.711284812490117*^9, 
   3.7112848658191395`*^9}, 3.7112976952303095`*^9, {3.711303892888295*^9, 
   3.7113039183902674`*^9}, {3.7113067737014728`*^9, 3.711306778503993*^9}, {
   3.7113083050615215`*^9, 3.711308322855015*^9}, {3.7113086918642073`*^9, 
   3.7113086970055556`*^9}, {3.7113123015775733`*^9, 3.7113123054444995`*^9}, 
   3.711804615512993*^9, {3.7164722195683403`*^9, 3.716472224394517*^9}, {
   3.716472590848653*^9, 3.7164725912246723`*^9}, {3.7164726238026457`*^9, 
   3.716472630051078*^9}, {3.7164726711981063`*^9, 3.716472675855012*^9}, {
   3.716472717142142*^9, 3.7164727349212666`*^9}},
 ExpressionUUID -> "d7a23572-f78e-46c9-92a6-b6ec4e598508"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup indirect targeting of men and of women <9 and 50+", \
"Subsubsection",
 CellChangeTimes->{{3.7112968895988717`*^9, 3.7112969164478703`*^9}, 
   3.7113084881397305`*^9},
 ExpressionUUID -> "31d1db40-b745-443f-929e-118b1b9be8a9"],

Cell["\<\
Compute age group targeting for Puerto Rico, under the \[OpenCurlyQuote]best \
fit\[CloseCurlyQuote] attack rate, 90% coverage with 75% efficacy vaccine\
\>", "Text",
 CellChangeTimes->{{3.7112848777531595`*^9, 3.711284900497135*^9}},
 ExpressionUUID -> "a1cbf7e0-2616-4e71-b15d-dbdb5a5bb68f"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "indirectProtection"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indirectProtection", "[", 
    RowBox[{"country_", ",", "attR_", ",", 
     RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vrate", "=", "0.9"}], ",", 
       RowBox[{"veff", "=", "0.75"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"data", "=", 
           RowBox[{"runFrontierScenarios", "[", 
            RowBox[{
            "country", ",", "attR", ",", "basemodel", ",", "vrate", ",", 
             "veff", ",", "True", ",", "200", ",", "200", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "99"}], "]"}], ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "99"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"15", ",", "49"}], "]"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"lag", "\[Equal]", "0"}], ",", "10", ",", "15"}], 
              "]"}], ",", "0", ",", "0", ",", "lag"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Association", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
             RowBox[{"pullAllVaccines", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
             RowBox[{"pullPrenatalInfections", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
             RowBox[{"pullPregnancies", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<population\>\"", "\[Rule]", 
             RowBox[{"pullAllPopulation", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.711219521342289*^9, 3.7112195798893557`*^9}, {
   3.7112204911736784`*^9, 3.711220510854018*^9}, {3.7112205648339515`*^9, 
   3.7112205732561655`*^9}, {3.7112207275745983`*^9, 3.711220761200269*^9}, {
   3.7112211038562737`*^9, 3.711221126125988*^9}, {3.711221157796819*^9, 
   3.7112213529884443`*^9}, {3.7112214737320886`*^9, 
   3.7112216005815125`*^9}, {3.711221646669015*^9, 3.711221662478444*^9}, {
   3.7112218609755125`*^9, 3.7112218665180483`*^9}, {3.7112219046675158`*^9, 
   3.711221916157387*^9}, {3.7112227992655044`*^9, 3.7112228056536245`*^9}, {
   3.7112847040913877`*^9, 3.7112847577223864`*^9}, {3.711284812490117*^9, 
   3.7112848658191395`*^9}, {3.711296930245633*^9, 3.7112969495294247`*^9}, {
   3.711297061441799*^9, 3.7112971226824646`*^9}, {3.7112971900607314`*^9, 
   3.711297255402499*^9}, {3.7112972900617294`*^9, 3.7112973446556406`*^9}, {
   3.711297405760354*^9, 3.7112974097088146`*^9}, 3.7112974849688535`*^9, {
   3.7112980017123137`*^9, 3.711298057977167*^9}, {3.71130370442082*^9, 
   3.711303735501164*^9}, {3.7113037679217205`*^9, 3.7113037714326444`*^9}, {
   3.711306788455186*^9, 3.711306797623336*^9}, {3.7113083351727753`*^9, 
   3.7113083615024166`*^9}, 3.7118046230068593`*^9, {3.7164722077186365`*^9, 
   3.716472210374917*^9}},
 ExpressionUUID -> "42ac9fa5-b549-43d6-ae82-bb1ae673e112"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "indirectProtectionLow"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indirectProtectionLow", "[", 
    RowBox[{"country_", ",", "attR_", ",", 
     RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vrate", "=", "0.01"}], ",", 
       RowBox[{"veff", "=", "0.75"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"data", "=", 
           RowBox[{"runFrontierScenarios", "[", 
            RowBox[{
            "country", ",", "attR", ",", "basemodel", ",", "vrate", ",", 
             "veff", ",", "True", ",", "200", ",", "200", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "99"}], "]"}], ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"0", ",", "99"}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"15", ",", "49"}], "]"}]}], "]"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"lag", "\[Equal]", "0"}], ",", "10", ",", "15"}], 
              "]"}], ",", "0", ",", "0", ",", "lag"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Association", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
             RowBox[{"pullAllVaccines", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
             RowBox[{"pullPrenatalInfections", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
             RowBox[{"pullPregnancies", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<population\>\"", "\[Rule]", 
             RowBox[{"pullAllPopulation", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.711219521342289*^9, 3.7112195798893557`*^9}, {
   3.7112204911736784`*^9, 3.711220510854018*^9}, {3.7112205648339515`*^9, 
   3.7112205732561655`*^9}, {3.7112207275745983`*^9, 3.711220761200269*^9}, {
   3.7112211038562737`*^9, 3.711221126125988*^9}, {3.711221157796819*^9, 
   3.7112213529884443`*^9}, {3.7112214737320886`*^9, 
   3.7112216005815125`*^9}, {3.711221646669015*^9, 3.711221662478444*^9}, {
   3.7112218609755125`*^9, 3.7112218665180483`*^9}, {3.7112219046675158`*^9, 
   3.711221916157387*^9}, {3.7112227992655044`*^9, 3.7112228056536245`*^9}, {
   3.7112847040913877`*^9, 3.7112847577223864`*^9}, {3.711284812490117*^9, 
   3.7112848658191395`*^9}, {3.711296930245633*^9, 3.7112969495294247`*^9}, {
   3.711297061441799*^9, 3.7112971226824646`*^9}, {3.7112971900607314`*^9, 
   3.711297255402499*^9}, {3.7112972900617294`*^9, 3.7112973446556406`*^9}, {
   3.711297405760354*^9, 3.7112974097088146`*^9}, 3.7112974849688535`*^9, {
   3.7112980017123137`*^9, 3.711298057977167*^9}, {3.71130370442082*^9, 
   3.711303735501164*^9}, {3.7113037679217205`*^9, 3.7113037714326444`*^9}, {
   3.711306788455186*^9, 3.711306797623336*^9}, {3.7113083351727753`*^9, 
   3.7113083615024166`*^9}, 3.7118046230068593`*^9, {3.7164722077186365`*^9, 
   3.716472210374917*^9}, {3.716472808283393*^9, 3.7164728131277204`*^9}},
 ExpressionUUID -> "e8ec6f61-8e6d-40cc-94bb-a210723efb1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup targeting of men 15-49", "Subsubsection",
 CellChangeTimes->{{3.7112968895988717`*^9, 3.7112969164478703`*^9}, 
   3.7113084881397305`*^9, {3.711799088379123*^9, 3.7117990916016183`*^9}, {
   3.711799124281358*^9, 3.711799124328233*^9}},
 ExpressionUUID -> "5c0ee703-ccd1-4419-9dfd-3841ce9676fb"],

Cell["\<\
Compute age group targeting for Puerto Rico, under the \[OpenCurlyQuote]best \
fit\[CloseCurlyQuote] attack rate, 90% coverage with 75% efficacy vaccine\
\>", "Text",
 CellChangeTimes->{{3.7112848777531595`*^9, 3.711284900497135*^9}},
 ExpressionUUID -> "617faa68-7c96-428c-820d-f83278bb21c0"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "targetMen"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"targetMen", "[", 
    RowBox[{"country_", ",", "attR_", ",", 
     RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vrate", "=", "0.9"}], ",", 
       RowBox[{"veff", "=", "0.75"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"data", "=", 
           RowBox[{"runFrontierScenarios", "[", 
            RowBox[{
            "country", ",", "attR", ",", "basemodel", ",", "vrate", ",", 
             "veff", ",", "True", ",", "200", ",", "200", ",", 
             RowBox[{"{", 
              RowBox[{"15", ",", "49"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"200", ",", "200"}], "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"lag", "\[Equal]", "0"}], ",", "10", ",", "15"}], 
              "]"}], ",", "0", ",", "0", ",", "lag"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Association", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
             RowBox[{"pullAllVaccines", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
             RowBox[{"pullPrenatalInfections", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
             RowBox[{"pullPregnancies", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<population\>\"", "\[Rule]", 
             RowBox[{"pullAllPopulation", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.711219521342289*^9, 3.7112195798893557`*^9}, {
   3.7112204911736784`*^9, 3.711220510854018*^9}, {3.7112205648339515`*^9, 
   3.7112205732561655`*^9}, {3.7112207275745983`*^9, 3.711220761200269*^9}, {
   3.7112211038562737`*^9, 3.711221126125988*^9}, {3.711221157796819*^9, 
   3.7112213529884443`*^9}, {3.7112214737320886`*^9, 
   3.7112216005815125`*^9}, {3.711221646669015*^9, 3.711221662478444*^9}, {
   3.7112218609755125`*^9, 3.7112218665180483`*^9}, {3.7112219046675158`*^9, 
   3.711221916157387*^9}, {3.7112227992655044`*^9, 3.7112228056536245`*^9}, {
   3.7112847040913877`*^9, 3.7112847577223864`*^9}, {3.711284812490117*^9, 
   3.7112848658191395`*^9}, {3.711296930245633*^9, 3.7112969495294247`*^9}, {
   3.711297061441799*^9, 3.7112971226824646`*^9}, {3.7112971900607314`*^9, 
   3.711297255402499*^9}, {3.7112972900617294`*^9, 3.7112973446556406`*^9}, {
   3.711297405760354*^9, 3.7112974097088146`*^9}, 3.7112974849688535`*^9, {
   3.7112980017123137`*^9, 3.711298057977167*^9}, {3.71130370442082*^9, 
   3.711303735501164*^9}, {3.7113037679217205`*^9, 3.7113037714326444`*^9}, {
   3.711306788455186*^9, 3.711306797623336*^9}, {3.7113083351727753`*^9, 
   3.7113083615024166`*^9}, {3.711799096604725*^9, 3.7117991004082737`*^9}, {
   3.711799139583639*^9, 3.7117991396773906`*^9}, {3.7117991871618347`*^9, 
   3.7117991989705*^9}, 3.711804627998743*^9, {3.7164721862227306`*^9, 
   3.7164721921433783`*^9}},
 ExpressionUUID -> "fec6b67b-12f0-4957-a86b-dfae523cf1d7"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "targetMenLow"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"targetMenLow", "[", 
    RowBox[{"country_", ",", "attR_", ",", 
     RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vrate", "=", "0.01"}], ",", 
       RowBox[{"veff", "=", "0.75"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basemodel", "=", 
         RowBox[{"Get", "[", 
          RowBox[{
          "\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}], 
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"data", "=", 
           RowBox[{"runFrontierScenarios", "[", 
            RowBox[{
            "country", ",", "attR", ",", "basemodel", ",", "vrate", ",", 
             "veff", ",", "True", ",", "200", ",", "200", ",", 
             RowBox[{"{", 
              RowBox[{"15", ",", "49"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"200", ",", "200"}], "}"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"lag", "\[Equal]", "0"}], ",", "10", ",", "15"}], 
              "]"}], ",", "0", ",", "0", ",", "lag"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Association", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<vaccines\>\"", "\[Rule]", 
             RowBox[{"pullAllVaccines", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<prenatalInfections\>\"", "\[Rule]", 
             RowBox[{"pullPrenatalInfections", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<pregnancies\>\"", "\[Rule]", 
             RowBox[{"pullPregnancies", "[", 
              RowBox[{
              "data", ",", "country", ",", "AgeClasses", ",", "True"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<population\>\"", "\[Rule]", 
             RowBox[{"pullAllPopulation", "[", 
              RowBox[{"data", ",", "AgeClasses", ",", "True"}], "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.711219521342289*^9, 3.7112195798893557`*^9}, {
   3.7112204911736784`*^9, 3.711220510854018*^9}, {3.7112205648339515`*^9, 
   3.7112205732561655`*^9}, {3.7112207275745983`*^9, 3.711220761200269*^9}, {
   3.7112211038562737`*^9, 3.711221126125988*^9}, {3.711221157796819*^9, 
   3.7112213529884443`*^9}, {3.7112214737320886`*^9, 
   3.7112216005815125`*^9}, {3.711221646669015*^9, 3.711221662478444*^9}, {
   3.7112218609755125`*^9, 3.7112218665180483`*^9}, {3.7112219046675158`*^9, 
   3.711221916157387*^9}, {3.7112227992655044`*^9, 3.7112228056536245`*^9}, {
   3.7112847040913877`*^9, 3.7112847577223864`*^9}, {3.711284812490117*^9, 
   3.7112848658191395`*^9}, {3.711296930245633*^9, 3.7112969495294247`*^9}, {
   3.711297061441799*^9, 3.7112971226824646`*^9}, {3.7112971900607314`*^9, 
   3.711297255402499*^9}, {3.7112972900617294`*^9, 3.7112973446556406`*^9}, {
   3.711297405760354*^9, 3.7112974097088146`*^9}, 3.7112974849688535`*^9, {
   3.7112980017123137`*^9, 3.711298057977167*^9}, {3.71130370442082*^9, 
   3.711303735501164*^9}, {3.7113037679217205`*^9, 3.7113037714326444`*^9}, {
   3.711306788455186*^9, 3.711306797623336*^9}, {3.7113083351727753`*^9, 
   3.7113083615024166`*^9}, {3.711799096604725*^9, 3.7117991004082737`*^9}, {
   3.711799139583639*^9, 3.7117991396773906`*^9}, {3.7117991871618347`*^9, 
   3.7117991989705*^9}, 3.711804627998743*^9, {3.7164721862227306`*^9, 
   3.7164721921433783`*^9}, {3.7164728316710176`*^9, 3.716472836747881*^9}},
 ExpressionUUID -> "c4704522-2af6-45f0-888e-03de9a18c66a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run all cluster", "Subsubsection",
 CellChangeTimes->{{3.7113084597145433`*^9, 3.7113084605582952`*^9}, {
   3.711804639669835*^9, 3.7118046407394037`*^9}, 3.711810035983915*^9},
 ExpressionUUID -> "97e68a03-73e4-44fe-addf-aa83480f6a92"],

Cell["\<\
Command line 1st: country index (1-34)
Command line 2nd: attack rate
Command line 3rd: lag before vaccine kicks in\
\>", "Text",
 CellChangeTimes->{{3.711303359129772*^9, 3.711303373255251*^9}, {
   3.7113070377487135`*^9, 3.711307043199242*^9}, {3.7113081735493264`*^9, 
   3.7113081806124783`*^9}, 3.716472177497498*^9},
 ExpressionUUID -> "ee6f300b-54cc-42a4-a0f2-b986a417cd44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"country", "=", 
       RowBox[{"CountryNames", "[", 
        RowBox[{"[", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"$CommandLine", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"attR", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"$CommandLine", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"lag", "=", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"$CommandLine", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"noVaccineResult", "[", 
         RowBox[{"country", ",", "attR", ",", "lag"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<noVaccineResult\>\"", "<>", "\"\<_\>\"", "<>", "country", "<>", 
         "\"\<_attR_\>\"", "<>", 
         RowBox[{"ToString", "[", "attR", "]"}], "<>", "\"\<_lag_\>\"", "<>", 
         RowBox[{"ToString", "[", "lag", "]"}], "<>", "\"\<.dat\>\""}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"indirectProtection", "[", 
         RowBox[{"country", ",", "attR", ",", "lag"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<indirectProtection\>\"", "<>", "\"\<_\>\"", "<>", "country", 
         "<>", "\"\<_attR_\>\"", "<>", 
         RowBox[{"ToString", "[", "attR", "]"}], "<>", "\"\<_lag_\>\"", "<>", 
         RowBox[{"ToString", "[", "lag", "]"}], "<>", "\"\<.dat\>\""}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"vaccResultsFrontier", "[", 
         RowBox[{"country", ",", "attR", ",", "lag"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<resultsFrontier\>\"", "<>", "\"\<_\>\"", "<>", "country", "<>", 
         "\"\<_attR_\>\"", "<>", 
         RowBox[{"ToString", "[", "attR", "]"}], "<>", "\"\<_lag_\>\"", "<>", 
         RowBox[{"ToString", "[", "lag", "]"}], "<>", "\"\<.dat\>\""}]}], 
       "]"}], ";", "\n", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"targetMen", "[", 
         RowBox[{"country", ",", "attR", ",", "lag"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<targetMen\>\"", "<>", "\"\<_\>\"", "<>", "country", "<>", 
         "\"\<_attR_\>\"", "<>", 
         RowBox[{"ToString", "[", "attR", "]"}], "<>", "\"\<_lag_\>\"", "<>", 
         RowBox[{"ToString", "[", "lag", "]"}], "<>", "\"\<.dat\>\""}]}], 
       "]"}], ";", "\n", "\n", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"vaccResults5yr", "[", 
         RowBox[{"country", ",", "attR", ",", "lag"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<vaccResults5yr\>\"", "<>", "\"\<_\>\"", "<>", "country", "<>", 
         "\"\<_attR_\>\"", "<>", 
         RowBox[{"ToString", "[", "attR", "]"}], "<>", "\"\<_lag_\>\"", "<>", 
         RowBox[{"ToString", "[", "lag", "]"}], "<>", "\"\<.dat\>\""}]}], 
       "]"}], ";", "\n", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"indirectProtectionLow", "[", 
         RowBox[{"country", ",", "attR", ",", "lag"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<indirectProtectionLow\>\"", "<>", "\"\<_\>\"", "<>", "country", 
         "<>", "\"\<_attR_\>\"", "<>", 
         RowBox[{"ToString", "[", "attR", "]"}], "<>", "\"\<_lag_\>\"", "<>", 
         RowBox[{"ToString", "[", "lag", "]"}], "<>", "\"\<.dat\>\""}]}], 
       "]"}], ";", "\n", 
      RowBox[{"Put", "[", 
       RowBox[{
        RowBox[{"targetMenLow", "[", 
         RowBox[{"country", ",", "attR", ",", "lag"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
        "\"\<targetMenLow\>\"", "<>", "\"\<_\>\"", "<>", "country", "<>", 
         "\"\<_attR_\>\"", "<>", 
         RowBox[{"ToString", "[", "attR", "]"}], "<>", "\"\<_lag_\>\"", "<>", 
         RowBox[{"ToString", "[", "lag", "]"}], "<>", "\"\<.dat\>\""}]}], 
       "]"}], ";"}], "\n", "\n", ")"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.711225968146036*^9, 3.7112259822294188`*^9}, {
  3.7112964070248766`*^9, 3.7112964083450255`*^9}, {3.7113033145641937`*^9, 
  3.711303405991724*^9}, {3.7113034409879413`*^9, 3.7113034758032336`*^9}, {
  3.7113035180111265`*^9, 3.7113035214823875`*^9}, {3.71130667279644*^9, 
  3.711306759918189*^9}, {3.7113069301159067`*^9, 3.7113069920987883`*^9}, {
  3.711308190221903*^9, 3.711308265909309*^9}, {3.711308520044895*^9, 
  3.7113086532461457`*^9}, {3.7118016725939617`*^9, 3.7118016910987487`*^9}, {
  3.71191150579508*^9, 3.7119115317582417`*^9}, {3.716472124734913*^9, 
  3.716472152056224*^9}, {3.716472775196573*^9, 3.716472786703494*^9}, {
  3.716472821193199*^9, 3.716472901626723*^9}},
 ExpressionUUID -> "de5cbaf3-dbb4-4713-8371-d833dff82025"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7113040772788267`*^9},
 ExpressionUUID -> "5e0be3a0-cd8b-4d7f-ba52-d7cad3bd0b5c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Synopsis", "Subsubsection",
 CellChangeTimes->{{3.711304802936411*^9, 3.711304803971035*^9}},
 ExpressionUUID -> "86aa6dfe-f80e-40ff-b0c9-791fd71d2e66"],

Cell[TextData[{
 "Mathematica \[OpenCurlyDoubleQuote]code\[CloseCurlyDoubleQuote] sections \
designate those code blocks to be run on the cluster. The corresponding ",
 StyleBox["runscript.py",
  FontWeight->"Bold"],
 " file is:"
}], "Text",
 CellChangeTimes->{{3.7113048131337767`*^9, 3.7113048354291673`*^9}},
 ExpressionUUID -> "b8f45ebc-e703-4cc7-8358-676142b6c14d"],

Cell["\<\
with open(\"./scriptfile\", \"w\") as out:
\tfor country in range(34):
\t\tfor attR in [0.25, 0.5]:
\t\t\tout.write(\"cd ~/project/Zika/AgeScenarios/; \")
\t\t\tout.write(\"math \")
\t\t\tout.write(str(country+1))
\t\t\tout.write(\" \")
\t\t\tout.write(str(attR))
\t\t\tout.write(\" -script GenerateZikaResults.m\\n\")\
\>", "Program",
 CellChangeTimes->{{3.71130487608272*^9, 3.7113049064424796`*^9}},
 ExpressionUUID -> "8dda6a10-f4a1-4f92-be07-1c548917aa2d"],

Cell[TextData[{
 "The corresponding ",
 StyleBox["run.sh",
  FontWeight->"Bold"],
 " file is:"
}], "Text",
 CellChangeTimes->{{3.7113048580150604`*^9, 3.7113048644067683`*^9}},
 ExpressionUUID -> "2891f193-ad49-4e1e-a805-0d03d7adc350"],

Cell["\<\
#!/bin/bash

#SBATCH --ntasks=100 --mem-per-cpu=2000
#SBATCH -J SimpleQueue
#SBATCH -p general
#SBATCH -t 240:00:00
#SBATCH -o SBATCH_SimpleQueue_out.txt
#SBATCH -e SBATCH_SimpleQueue_err.txt

module load NWS

SQDIR=\"/ysm-gpfs/project/dpd8/ZikaDengue/MC/SQ_Files_${SLURM_JOB_ID}\"
mkdir \"$SQDIR\"
exec > \"$SQDIR/PBS_script.log\"
echo \"$(date +'%F %T') Batch script starting in earnest (pid: $$).\"
echo \"$(date +'%F %T') About to execute \
/ysm-gpfs/apps/software/SimpleQueue/3.1/SQDedDriver.py using task file: \
scriptfile\"

python \"/ysm-gpfs/apps/software/SimpleQueue/3.1/SQDedDriver.py\" \\
  --logFile=\"$SQDIR/SQ.log\" \\
  --pnwss --wrapperVerbose \\
  \"scriptfile\"
RETURNCODE=$?
echo \"$(date +'%F %T') Writing exited file.\"
touch \"$SQDIR/exited\"
echo \"$(date +'%F %T') Batch script exiting, $RETURNCODE.\"\
\>", "Program",
 CellChangeTimes->{{3.71130487608272*^9, 3.7113048787967076`*^9}},
 ExpressionUUID -> "6239dc22-da17-4858-b86b-715a9637f6db"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Run uncertainty analysis", "Section",
 CellChangeTimes->{{3.711316967669524*^9, 3.711316981304967*^9}, {
  3.71173313375811*^9, 3.711733135040681*^9}},
 ExpressionUUID -> "1e944295-b4b5-4879-8dee-9cfc152527e9"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{"(*", 
   RowBox[{"UNCERTAINTY", " ", "ANALYSIS", " ", "SECTION"}], "*)"}], 
  "\n"}]], "Code",
 CellChangeTimes->{{3.7117330714145665`*^9, 3.711733082405269*^9}},
 ExpressionUUID -> "dceea200-0e36-4174-b883-07463ee52fd9"],

Cell["\<\
This section consists of two components: 
1) MLE Uncertainty Analysis is run on a desktop to generate the \
\[OpenCurlyQuote]best fit\[CloseCurlyQuote] trajectory
2) Monte Carlo simulation is run on the cluster to generate an ensemble of \
outputs. Each output is compared with the MLE results in the \
\[OpenCurlyDoubleQuote]PlotResults\[CloseCurlyDoubleQuote] file, in order to \
select the 1000 runs with the best fit\
\>", "Text",
 CellChangeTimes->{{3.714303182345213*^9, 3.714303241586295*^9}},
 ExpressionUUID -> "3c770ae9-e181-4f0c-9ee6-281bbae292df"],

Cell[CellGroupData[{

Cell["Define prior distributions for parameters", "Subsection",
 CellChangeTimes->{{3.7113169844976377`*^9, 3.7113169881935*^9}},
 ExpressionUUID -> "7db9c08d-30ec-4bb0-92c6-bc61631f8c82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"priorDistribution", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"SampledParameters", ",", 
     RowBox[{"{", "10000", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.711319316247094*^9, 3.7113193257899113`*^9}, 
   3.711392020996103*^9},
 ExpressionUUID -> "5373b934-6f43-4294-9486-f06c16b63f15"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.711319329692367*^9, 3.7113193331080146`*^9}},
 ExpressionUUID -> "21fedb83-0f3c-4ca8-82d6-3e5963b1f074"],

Cell[BoxData["\<\"C:\\\\Users\\\\carbon\\\\Dropbox\\\\Code\\\\Git\\\\\
ZikaVaccineModel\"\>"], "Output",
 CellChangeTimes->{3.711319334106326*^9, 3.711392024043707*^9, 
  3.7164751461614265`*^9},
 ExpressionUUID -> "100f3bfd-1d52-406f-b561-f0421f1bf678"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Put", "[", 
   RowBox[{"priorDistribution", ",", "\"\<priorDistribution.dat\>\""}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.711319334787959*^9, 3.71131934906159*^9}},
 ExpressionUUID -> "80b8725e-460e-470a-a6a0-184b30665341"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup scenario run", "Subsection",
 CellChangeTimes->{{3.7113169990793076`*^9, 3.7113170027729363`*^9}, {
  3.711317121787751*^9, 3.7113171264757156`*^9}},
 ExpressionUUID -> "e15cf14a-c793-419b-a87f-4cb2c624ff35"],

Cell[CellGroupData[{

Cell["Read in prior distribution", "Subsubsection",
 CellChangeTimes->{{3.711319360738583*^9, 3.7113193641300316`*^9}},
 ExpressionUUID -> "71fb3901-b155-441e-8c0f-a7f9749ba5a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.711319329692367*^9, 3.7113193331080146`*^9}},
 ExpressionUUID -> "6e743c11-bfbe-43d3-8b30-33c654b290ef"],

Cell[BoxData["\<\"D:\\\\Dropbox\\\\Code\\\\Git\\\\ZikaVaccineModel\"\>"], \
"Output",
 CellChangeTimes->{3.711319334106326*^9, 3.7113897806010895`*^9, 
  3.711389869170906*^9, 3.7143033800232253`*^9, 3.7151778939974065`*^9, 
  3.716475207398266*^9, 3.716475840404525*^9},
 ExpressionUUID -> "30eb64be-f80c-4b1d-84b4-2fadfeae2f74"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"priorDistribution", "=", 
   RowBox[{"Get", "[", "\"\<priorDistribution.dat\>\"", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.711319334787959*^9, 3.711319372252602*^9}},
 ExpressionUUID -> "82f0493f-ff96-4a10-bc38-88296eb74217"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup code", "Subsubsection",
 CellChangeTimes->{{3.7112192748980975`*^9, 3.7112192766403723`*^9}, {
  3.711226002598155*^9, 3.7112260030327415`*^9}},
 ExpressionUUID -> "dfdc4064-7ce7-4f65-bd02-0ad9cb605261"],

Cell["\<\
Assumptions / specifications for the \[OpenCurlyDoubleQuote]cases averted per \
vaccine\[CloseCurlyDoubleQuote] analysis:
1) Use a small vaccination rate of 0.01 to minimize nonlinear impact
2) Disable annual coverage, so only consider one-time mass vaccination\
\>", "Text",
 CellChangeTimes->{{3.711297748134208*^9, 3.711297804621227*^9}},
 ExpressionUUID -> "06bb768d-df54-4dcb-ba83-29b5e5b05737"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "runBasicComparison"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"runBasicComparison", "[", 
   RowBox[{
   "country_", ",", "attackRate_", ",", "basemodel_", ",", "vrate_", ",", 
    "veff_", ",", "mvacc_", ",", "vlow_", ",", "vhigh_", ",", 
    RowBox[{"overridePars_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"maleAgeRange_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"femaleAgeRange_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"endyr_:", "10"}], ",", 
    RowBox[{"priorR_:", "0"}], ",", 
    RowBox[{"ageover_:", "0"}], ",", 
    RowBox[{"lag_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"betaHV", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"attackRate", "\[Equal]", "\"\<Best fit\>\""}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"betaHV", "/.", "overridePars"}], "/.", 
           RowBox[{"{", 
            RowBox[{"betaHV", "\[Rule]", "betaBestFit"}], "}"}]}], ")"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"calibratedTransmissionRates", "[", "country", "]"}], "[", 
          "attackRate", "]"}]}], "]"}]}], ",", 
      RowBox[{"betaMF", "=", "0.1"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"quantifyImpact", "[", "\[IndentingNewLine]", 
     RowBox[{
     "basemodel", ",", "country", ",", "betaHV", ",", "betaMF", ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Vaccination", " ", "scenario", " ", "parameters"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"annualcovg", "\[Rule]", "True"}], ",", 
        RowBox[{"vaccrate", "\[Rule]", "vrate"}], ",", 
        RowBox[{"vacceff", "\[Rule]", "veff"}], ",", 
        RowBox[{"femalevacc", "\[Rule]", "True"}], ",", 
        RowBox[{"malevacc", "\[Rule]", "mvacc"}], ",", 
        RowBox[{"vaccagelow", "\[Rule]", "vlow"}], ",", 
        RowBox[{"vaccagehigh", "\[Rule]", "vhigh"}], ",", 
        RowBox[{"maleagerange", "\[Rule]", "maleAgeRange"}], ",", 
        RowBox[{"femaleagerange", "\[Rule]", "femaleAgeRange"}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Append", "[", 
       RowBox[{"overridePars", ",", 
        RowBox[{"seasonalityFunction", "[", "country", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "0", ",", "endyr", ",", "priorR", ",", "ageover",
       ",", "lag"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.7112193528034077`*^9, 3.7112193742970552`*^9}, {
   3.7112194261807623`*^9, 3.7112194498964*^9}, {3.711219484971417*^9, 
   3.711219562406809*^9}, {3.7112196837383394`*^9, 3.71121971679076*^9}, {
   3.7112204039790034`*^9, 3.711220455325137*^9}, {3.711220517738079*^9, 
   3.7112205196906853`*^9}, {3.7112206371423955`*^9, 
   3.7112206686070986`*^9}, {3.7112207024726315`*^9, 
   3.7112207177257037`*^9}, {3.7112208822246675`*^9, 3.71122088313743*^9}, {
   3.7112977448524513`*^9, 3.71129774521634*^9}, {3.7112978098442154`*^9, 
   3.7112978676094847`*^9}, {3.711297924918034*^9, 3.7112979297730284`*^9}, {
   3.7113064883163433`*^9, 3.711306580334937*^9}, {3.7113080189791613`*^9, 
   3.711308057092841*^9}, {3.7113225550974174`*^9, 3.711322591601647*^9}, {
   3.711322786135879*^9, 3.7113228049646425`*^9}, {3.715109963801338*^9, 
   3.715109980747509*^9}, {3.715177988082076*^9, 3.715177999905572*^9}, 
   3.716475216083007*^9, {3.716475270028085*^9, 3.7164752818789377`*^9}, {
   3.7164753559853697`*^9, 3.7164753760191193`*^9}, {3.7164754404465265`*^9, 
   3.7164754578316708`*^9}},
 ExpressionUUID -> "00716ca5-94da-45ef-9849-101cb257df60"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define scenarios", "Subsubsection",
 CellChangeTimes->{{3.711323374871393*^9, 3.7113233763981237`*^9}},
 ExpressionUUID -> "68a1685d-151a-415d-8f52-4f4e2b2649c1"],

Cell["\<\
Run the following scenarios:
1) No vaccination
2) Coverage of 50% of women 9-49
3) Coverage of 50% population 9-49
4) Coverage of 90% of women 9-49
5) Coverage of 90% population 9-49\
\>", "Text",
 CellChangeTimes->{{3.711319730058462*^9, 3.711319747193835*^9}, {
  3.7113198391523266`*^9, 3.711319840814084*^9}, {3.711319880117081*^9, 
  3.7113198993356*^9}},
 ExpressionUUID -> "5bab49e8-3ac0-4df7-9be9-fb4c1c13465b"],

Cell["\<\
Report the following outcomes:
1) Vaccines
\ta) For the population
\tb) Among men
\tc) Among women
\td) Among women of each age group starting 9-14, then 5yr groups through 49
2) Prenatal infections
\ta) Among all women
\tb) Among women of each age group starting 9-14, then 5yr groups through 49
3) Pregnancies
\ta) Among all women
\tb) Among women of each age group starting 9-14, then 5yr groups through 49\
\>", "Text",
 CellChangeTimes->{{3.7113198474970365`*^9, 3.711319851913742*^9}, {
  3.71131990616343*^9, 3.711320048237094*^9}},
 ExpressionUUID -> "a064e7c7-d72a-4a0e-9e40-68c3ef9f1002"],

Cell[BoxData[{
 RowBox[{"Clear", "@", "returnUncertaintyAnalysis"}], "\n", 
 RowBox[{
  RowBox[{"returnUncertaintyAnalysis", "[", 
   RowBox[{
    RowBox[{"override_:", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"attRset_:", 
     RowBox[{"{", "\"\<Best fit\>\"", "}"}]}], ",", 
    RowBox[{"countryID_:", 
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"CountryNames", ",", "\"\<Puerto Rico\>\""}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"country", "=", 
      RowBox[{"CountryNames", "[", 
       RowBox[{"[", 
        RowBox[{"If", "[", 
         RowBox[{"ClusterRun", ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"$CommandLine", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "countryID"}], "]"}], 
        "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"basemodel", "=", 
        RowBox[{"Get", "[", 
         RowBox[{"\"\<basemodel\>\"", "<>", "country", "<>", "\"\<.dat\>\""}],
          "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"attR", "\[Rule]", "\[IndentingNewLine]", 
          RowBox[{"Association", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
               "mvacc", ",", "\"\<VaccinateMenAndWomen\>\"", ",", 
                "\"\<VaccinateWomen\>\""}], "]"}], "\[Rule]", 
              "\[IndentingNewLine]", 
              RowBox[{"Association", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"vrate", "\[Rule]", "\[IndentingNewLine]", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sol", "=", 
                    RowBox[{"runBasicComparison", "[", 
                    RowBox[{
                    "country", ",", "attR", ",", "basemodel", ",", "vrate", 
                    ",", "0.75", ",", "mvacc", ",", "9", ",", "49", ",", 
                    "override", ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", "}"}], ",", "10", ",", "0", ",", "0", ",", 
                    "0"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Association", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<PopulationVaccines\>\"", "\[Rule]", 
                    RowBox[{"pullAllVaccines", "[", 
                    RowBox[{"sol", ",", "AgeClasses", ",", "True"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<MaleVaccines\>\"", "\[Rule]", 
                    RowBox[{"pullMaleVaccines", "[", 
                    RowBox[{"sol", ",", "AgeClasses", ",", "True"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<FemaleVaccines\>\"", "\[Rule]", 
                    RowBox[{"pullFemaleVaccines", "[", 
                    RowBox[{"sol", ",", "AgeClasses", ",", "True"}], "]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<FemaleVaccinesAgeGroup\>\"", "\[Rule]", 
                    RowBox[{"Association", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", "agegroup", "]"}], "\[Rule]", 
                    RowBox[{"pullFemaleVaccines", "[", 
                    RowBox[{"sol", ",", "agegroup", ",", "True"}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"agegroup", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Range", "[", 
                    RowBox[{"9", ",", "14"}], "]"}], "}"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"15", ",", "49"}], "]"}], ",", "5"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<AllPrenatalInfections\>\"", "\[Rule]", 
                    RowBox[{"pullPrenatalInfections", "[", 
                    RowBox[{
                    "sol", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<PrenatalInfectionsAgeGroup\>\"", "\[Rule]", 
                    RowBox[{"Association", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", "agegroup", "]"}], "\[Rule]", 
                    RowBox[{"pullPrenatalInfections", "[", 
                    RowBox[{
                    "sol", ",", "country", ",", "agegroup", ",", "True"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"agegroup", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Range", "[", 
                    RowBox[{"9", ",", "14"}], "]"}], "}"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"15", ",", "49"}], "]"}], ",", "5"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<AllPregnancies\>\"", "\[Rule]", 
                    RowBox[{"pullPregnancies", "[", 
                    RowBox[{
                    "sol", ",", "country", ",", "AgeClasses", ",", "True"}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"\"\<PregnanciesAgeGroup\>\"", "\[Rule]", 
                    RowBox[{"Association", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ToString", "[", "agegroup", "]"}], "\[Rule]", 
                    RowBox[{"pullPregnancies", "[", 
                    RowBox[{
                    "sol", ",", "country", ",", "agegroup", ",", "True"}], 
                    "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"agegroup", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Range", "[", 
                    RowBox[{"9", ",", "14"}], "]"}], "}"}], ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"15", ",", "49"}], "]"}], ",", "5"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"vrate", ",", 
                   RowBox[{"Range", "[", 
                    RowBox[{"0", ",", "0.95", ",", "0.05"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"mvacc", ",", 
               RowBox[{"{", 
                RowBox[{"False", ",", "True"}], "}"}]}], "}"}]}], "]"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"attR", ",", "attRset"}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
   "]"}]}]}], "Code",
 CellChangeTimes->{{3.711391191321047*^9, 3.711391191321047*^9}, {
   3.711391222542061*^9, 3.7113913125157337`*^9}, {3.7119808336715655`*^9, 
   3.711980844975271*^9}, {3.7143032785587645`*^9, 3.71430328458715*^9}, {
   3.7143033933874164`*^9, 3.71430339683035*^9}, {3.7143034548560104`*^9, 
   3.714303520553358*^9}, 3.7151780857202177`*^9, {3.7164755222672367`*^9, 
   3.7164755233504515`*^9}, {3.7164755553510857`*^9, 3.716475560765448*^9}},
 ExpressionUUID -> "c4c8f109-279b-4a57-b2a8-571c2fc085aa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run scenarios", "Subsection",
 CellChangeTimes->{{3.7113171281397543`*^9, 3.711317129267758*^9}},
 ExpressionUUID -> "c615587e-2b10-494f-84c2-479a428aa475"],

Cell[CellGroupData[{

Cell["MLE on desktop", "Subsubsection",
 CellChangeTimes->{{3.7113171306686096`*^9, 3.7113171320037518`*^9}},
 ExpressionUUID -> "098355f1-d3f6-498e-9148-531849fab446"],

Cell["\<\
This section should be run once in order to generate the best-fit parameter \
set under MLE parameters. This result is for selecting the 1k best runs in \
the PlotResults uncertainty analysis\
\>", "Text",
 CellChangeTimes->{{3.715340986714322*^9, 3.715340993996174*^9}, {
  3.715341026337631*^9, 3.715341050932837*^9}},
 ExpressionUUID -> "7a320cf2-9996-44b6-9b2b-8431d085f0dd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"{", 
   RowBox[{"vrate", ",", "mvacc", ",", "attR"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7113899836007075`*^9, 3.7113899893115172`*^9}, {
  3.711391321019749*^9, 3.711391321707237*^9}},
 ExpressionUUID -> "d560d356-3e96-4458-9fdb-9e45063e6dfb"],

Cell[BoxData[
 DynamicBox[
  ToBoxes[{$CellContext`vrate, $CellContext`mvacc, $CellContext`attR}, 
   StandardForm],
  ImageSizeCache->{278., {5., 16.}}]], "Output",
 CellChangeTimes->{
  3.7113899928241715`*^9, 3.7113913220273004`*^9, 3.7113920424718685`*^9, 
   3.7143033012320104`*^9, 3.714303345996994*^9, 3.714303382919088*^9, {
   3.7143035069640265`*^9, 3.714303530979311*^9}, 3.7153409731354713`*^9, 
   3.716475869077339*^9},
 ExpressionUUID -> "916ab2ae-d8ba-4868-9e8e-d65b893ab986"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7113913327431917`*^9, 3.711391337311941*^9}},
 ExpressionUUID -> "507b2ca2-2b41-4d18-be2f-0ea3793cc016"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"mleUncertainty", "=", 
    RowBox[{"returnUncertaintyAnalysis", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "\"\<Best fit\>\"", "}"}]}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7113233863212953`*^9, 3.7113233937530813`*^9}, {
  3.711323426122258*^9, 3.7113234262264166`*^9}, {3.711389789368888*^9, 
  3.711389790948382*^9}, {3.7143033105222635`*^9, 3.714303339410231*^9}, {
  3.714303533223689*^9, 3.7143035397651157`*^9}},
 ExpressionUUID -> "094c8638-4f45-4f63-bc59-86b7004a10db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"472.9951185757034`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7113917441092873`*^9, 3.7113930412501955`*^9, {3.714303327666986*^9, 
   3.7143033527498283`*^9}, {3.7143033881806808`*^9, 3.714303412868916*^9}, 
   3.7143039661865377`*^9, 3.715341422952027*^9, 3.7164763478720865`*^9},
 ExpressionUUID -> "f15ea467-77f9-4a83-8d63-aacb92384107"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<\\\\GeneratedResults\\\\Uncertainty\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.7113876386514454`*^9, 3.711387639895475*^9}, {
  3.711388501364134*^9, 3.71138851362696*^9}, {3.71138858456769*^9, 
  3.711388586512808*^9}},
 ExpressionUUID -> "9b97073c-4a26-443c-8c27-0b0952147ece"],

Cell[BoxData["\<\"D:\\\\Dropbox\\\\Code\\\\Git\\\\ZikaVaccineModel\\\\\
GeneratedResults\\\\Uncertainty\"\>"], "Output",
 CellChangeTimes->{3.711388514402669*^9, 3.7113885870753202`*^9, 
  3.7113887490906715`*^9, 3.711389596365268*^9, 3.7113901017556562`*^9, 
  3.7113982042410836`*^9, 3.7143045437947345`*^9, 3.7153414230457277`*^9, 
  3.7164763479189243`*^9},
 ExpressionUUID -> "0cc10c8f-e0ba-497e-9785-2057c00aeb5f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{"mleUncertainty", ",", "\"\<mleUncertaintyDesktop.dat\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.711389802134783*^9, 3.7113898201498365`*^9}},
 ExpressionUUID -> "a93602b5-0ec1-4320-bdd8-6e67f552eca1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cluster configuration", "Subsubsection",
 CellChangeTimes->{{3.711317133349609*^9, 3.7113171352756076`*^9}},
 ExpressionUUID -> "15d519ed-af75-45e9-b2a6-4d1c36a7d42a"],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"ClusterRun", ",", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MCMCi", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"$CommandLine", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{"country", "=", 
        RowBox[{"CountryNames", "[", 
         RowBox[{"[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"$CommandLine", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "]"}]}]}], "}"}], 
     ",", "\n", 
     RowBox[{"Put", "[", 
      RowBox[{
       RowBox[{"returnUncertaintyAnalysis", "[", 
        RowBox[{
         RowBox[{"priorDistribution", "[", 
          RowBox[{"[", "MCMCi", "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"country", "\[Equal]", "\"\<Puerto Rico\>\""}], ",", 
           RowBox[{"{", "\"\<Best fit\>\"", "}"}], ",", 
           RowBox[{"{", "0.25", "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{
       "\"\<uncertaintyScenarios_\>\"", "<>", "country", "<>", "\"\<_\>\"", "<>", 
        RowBox[{"ToString", "[", "MCMCi", "]"}], "<>", "\"\<.dat\>\""}]}], 
      "]"}]}], "]"}]}], "\n", "]"}]], "Code",
 CellChangeTimes->{{3.711323739504801*^9, 3.7113238189006205`*^9}, {
  3.71198085360406*^9, 3.7119808793724394`*^9}, {3.7151781117695208`*^9, 
  3.715178121394541*^9}},
 ExpressionUUID -> "fe17319f-da5e-457f-93ad-f63723f532bd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 637},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.75 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
